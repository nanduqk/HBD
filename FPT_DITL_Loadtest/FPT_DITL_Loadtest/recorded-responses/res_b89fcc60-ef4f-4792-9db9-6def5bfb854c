define("zen.rt.components.vizframe/js/colorPalette/js/colorPaletteWidget/CreatePaletteDialog",["zen.rt.components.vizframe/js/referenceLines/common/js/colorPicker/ColorPicker","zen.rt.components.vizframe/js/colorPalette/js/colorPaletteWidget/GradientGenerator","zen.rt.components.vizframe/js/colorPalette/js/MessageBundle","zen.rt.components.vizframe/js/referenceLines/common/js/widgets/Dialog"],function(e,b,d,a){if(sap.ludsi==undefined){sap.ludsi={};}if(sap.ludsi&&sap.ludsi.PreferencesProxy){var c=sap.ludsi.PreferencesProxy;}sap.ludsi.CreatePaletteDialog=a.extend("sap.ludsi.CreatePaletteDialog",{metadata:{properties:{colorPaletteType:{type:"string",defaultValue:sap.ludsi.ColorPaletteType.QUALITATIVE},scales:{type:"object",defaultValue:[]},isEditThreshold:{type:"boolean",defaultValue:false},gradientEnabled:{type:"boolean",defaultValue:false},isCustomize:{type:"boolean",defaultValue:false},isCustomPalette:{type:"boolean",defaultValue:false},editPalette:{type:"object",defaultValue:null}},events:{ok:{parameters:{palette:{type:"object"}}}}},renderer:{},open:function(){this.destroyContent();this.destroyButtons();this.createContent();this.addStyleClass("sapLudsiColorPaletteDialog");sap.ludsi.Dialog.prototype.open.apply(this,arguments);},createContent:function(){if(this.getIsCustomize()){if(this.getIsEditThreshold()||this.getColorPaletteType()===sap.ludsi.ColorPaletteType.SEQUENTIAL){this.setTitle(d.getText("PALETTE_DIALOG_TITLE_CUSTOMIZE_MEASURE"));}else{this.setTitle(d.getText("PALETTE_DIALOG_TITLE_CUSTOMIZE_DIMENSION"));}}else{if(this.getColorPaletteType()===sap.ludsi.ColorPaletteType.QUALITATIVE){if(this.getEditPalette()){this.setTitle(d.getText("PALETTE_DIALOG_TITLE_EDIT_DIMENSION"));}else{this.setTitle(d.getText("PALETTE_DIALOG_TITLE_CREATE_DIMENSION"));}}else{if(this.getEditPalette()){this.setTitle(d.getText("PALETTE_DIALOG_TITLE_EDIT_MEASURE"));}else{this.setTitle(d.getText("PALETTE_DIALOG_TITLE_CREATE_MEASURE"));}}}this._dirtySwatches=[];this._dirtyThresholdCount=0;this._colorSwatchRadius=10;this._baseColorSwatchRadius=8;this._forceRect=false;this._toBeChecked=false;this.setGradientEnabled(true);this._isEdit=(this.getEditPalette()!=undefined)||(this.getEditPalette()!=null);var j=this.getScales(),h=true,g=new sap.m.VBox(),i;if(this.getIsEditThreshold()){this.setContentHeight("720px");this.setContentWidth("580px");}else{this.setContentWidth("500px");this.setContentHeight("500px");}j.forEach(function(o){if(o.feed==="color"){this._existingColorFeed=o;}}.bind(this));if(!this._existingColorFeed){if(this.getEditPalette()){this._existingColorFeed={};this._existingColorFeed.palette=this.getEditPalette().palette;}}if(this.getIsEditThreshold()){g.addItem(this._createBaseColorArea());}h=true;g.addItem(this._createNumArea().setVisible(h&&!(this.getColorPaletteType()==sap.ludsi.ColorPaletteType.QUALITATIVE)));if(this.getIsEditThreshold()){i=new sap.m.HBox();var l=new sap.m.HBox();var k=new sap.m.VBox();l.addItem(this._createSwatchArea().setVisible(h));l.addItem(this._createThresholdArea());k.addItem(l);k.addItem(this._createReverseArea());i.addItem(k);i.addItem(this._createColorPickerArea());g.addItem(i);}else{i=new sap.m.HBox();i.addItem(this._createSwatchArea().setVisible(h));i.addItem(this._createReverseArea());g.addItem(i);g.addItem(this._createColorPickerArea());}if(this.getColorPaletteType()==sap.ludsi.ColorPaletteType.SEQUENTIAL){g.addItem(this._createGradientCheckBoxArea());}var m=false;if(window.appContextParams&&window.appContextParams.installType==="addon"){m=true;}var n=true;if(m||(window.lumiraModes===undefined)){n=false;}g.addItem(this._createSaveArea().setVisible(n));g.addItem(this._createNameArea().setVisible(!(this.getIsCustomize()||this.getIsEditThreshold())));this._okButton=new sap.m.Button({press:this._okButtonPressed.bind(this),type:sap.m.ButtonType.Default,enabled:false});if(!this.getIsEditThreshold()&&!this.getIsCustomize()&&!this.getEditPalette()){this._okButton.setText(d.getText("PALETTE_CREATE"));}else{this._okButton.setText(d.getText("DIALOG_OK"));}this.addButton(this._okButton);this.setInitialFocus(this._okButton);this.getDefaultButton=function(){return this._okButton.getId();};var f=new sap.m.Button({text:d.getText("DIALOG_CANCEL"),press:this._cancelButtonPressed.bind(this)});this.addButton(f);if(!this.getIsCustomize()&&!this.getIsEditThreshold()){this._save.setVisible(false);this._save.setSelected(true);}g.addItem(this._createMessageArea());if(this._save.getSelected()&&this._nameInput.getValue()===""){this._updateOKButton({nameEmpty:true});}this.addContent(g);},_createMessageArea:function(){this._messageStrip=new sap.m.MessageStrip();this._messageStrip.setType("Error");this._messageStrip.setShowIcon(true);this._messageStrip.setShowCloseButton(false);this._messageStrip.setVisible(false);return this._messageStrip;},_showError:function(f){this._messageStrip.setText(f);this._messageStrip.setVisible(true);},_setBaseColor:function(n){var f=this._baseColorGroup.getGroupColors(),j=f.length,l=n.palette,k=l.length,m=k-j,g;if(m<0){for(g=m;g<0;++g){this._baseColorGroup.popSwatch();}}else{for(g=0;g<m;++g){var h=new sap.m.ColorSwatch({radius:this._baseColorSwatchRadius});this._baseColorGroup.addSwatch(h);}}this._baseName.setText(n.key);this._baseColorGroup.setGroupColors(l);this._existingColorFeed.palette=n.palette;this._colorSwatchGroup.setGroupColors(n.palette);if(m!=0){this._currentNumSelect.setSelectedKey(n.palette.length);this._currentNumChanged();}if(this._baseChangePopover&&this._baseChangePopover.isOpen()){this._baseChangePopover.close();}this._updateOKButton({dirtyError:false});},_createBaseColorArea:function(){var f=new sap.m.HBox();var h=this._existingColorFeed.palette;var o=new sap.m.Label({width:"112px",text:d.getText("PALETTE_MEASURE_PALETTE")});f.addItem(o);var n=h.length;this._baseName=new sap.m.Label({width:"112px",textAlign:sap.ui.core.TextAlign.End});if(this.getEditPalette()){this._baseName.setText(this.getEditPalette().key);}f.addItem(this._baseName);var g=new sap.m.ColorSwatchGroup({enabled:false,width:"248px"});for(var l=0;l<n;++l){var k=new sap.m.ColorSwatch({radius:this._baseColorSwatchRadius});g.addSwatch(k);}this._baseColorGroup=g.setGroupColors(h);this._baseColorGroup.addStyleClass("sapMColorSwatchG8");f.addItem(this._baseColorGroup);var m=new ColorPaletteWidget(null,{enableEdit:false,enableCreate:false,enableRemove:false});m._enableEdit=false;m._enableRemove=false;m._enableCreate=false;m.attachPaletteSelected(this._setBaseColor.bind(this));m.setOverridePaletteType("sequential");var j=new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("down","fpa")});j.attachPress(function(){if(this._baseChangePopover){this._baseChangePopover.destroy();}this._baseChangePopover=new sap.m.Popover({showHeader:false,placement:sap.m.PlacementType.Bottom,offsetX:-246,offsetY:4,showArrow:false});this._baseChangePopover.addContent(m.create());this._baseChangePopover.openBy(j);}.bind(this));f.addItem(j);return f;},_createThresholdArea:function(){this._thresholdArea=new sap.m.VBox();var j=this._getCurrentNumOfColors();var k=0;for(k=0;k<j;++k){var n=new sap.m.HBox();n.addItem(new sap.m.Label({text:d.getText("PALETTE_THRESHOLD_SEPARATOR")}));var h=new sap.m.Input({type:"Number",placeholder:d.getText("PALETTE_ENTER_THRESHOLD")}).addStyleClass("sapLudsiThresholdInput");h.attachLiveChange(this._initiateValidation.bind(this));n.addItem(h);this._thresholdArea.addItem(n);}var m=this._existingColorFeed;this._thresholds=[];this._thresholds.push(m.legendValues[0]);var g=m.legendValues[0];var f=m.legendValues[m.legendValues.length-1];var l=f-g;for(k=0;k<j;++k){if(!isNaN(m.legendValues[k+1])){if(Math.abs(l)<=1){this._thresholdArea.getItems()[k].getItems()[1].setValue(+m.legendValues[k+1].toFixed(5));}else{if(Math.abs(l)<=100){this._thresholdArea.getItems()[k].getItems()[1].setValue(+m.legendValues[k+1].toFixed(2));}else{this._thresholdArea.getItems()[k].getItems()[1].setValue(Math.round(m.legendValues[k+1]));}}}}return this._thresholdArea;},_calculateThresholds:function(){if(!this.getIsEditThreshold()){return;}this._thresholds=[];var h=this._existingColorFeed;var n=h.legendValues;var f=this._getCurrentNumOfColors();var m=n[n.length-1];var j=n[0];var o=m-j;var g=o/f;this._thresholds.push(j);for(var l=1;l<=f;++l){var k=0;if(Math.abs(o)<=1){k=+(this._thresholds[l-1]+g).toFixed(5);}else{if(Math.abs(o)<=100){k=+(this._thresholds[l-1]+g).toFixed(2);}else{k=Math.round(this._thresholds[l-1]+g);}}this._thresholds.push(k);this._thresholdArea.getItems()[l-1].getItems()[1].setValue(k);}},_initiateValidation:function(f){this._validateThreshold(f.getSource());var g,h=this._thresholdArea.getItems().indexOf(f.getSource());for(g=h+1;g<this._thresholdArea.getItems().length;++g){this._validateThreshold(this._thresholdArea.getItems()[g].getItems()[1]);}for(g=h-1;g>=0;--g){this._validateThreshold(this._thresholdArea.getItems()[g].getItems()[1]);}},_validateThreshold:function(k){var n=k.getParent();var r=parseFloat(k.getValue());var s=this._thresholdArea.getItems().indexOf(n);var p=this._thresholdArea.getItems()[s-1];var o=this._thresholdArea.getItems()[s+1];var g=null;if(p){g=p.getItems()[1];}var j=null;if(o){j=o.getItems()[1];}var i=null;if(g){i=parseFloat(g.getValue());}else{i=parseFloat(r-1);}var q=null;if(j){q=parseFloat(j.getValue());}var m=false;var l=false;if(i||i==0){m=r>i;l=r<i;}else{m=true;l=true;}if(q){m=m&&(q>r);l=l&&(q<r);}var f=(l&&!m)||(!l&&m);if(m&&f){f=true;}else{f=false;}var h=this._colorSwatchGroup.getSwatches()[s];if(h.getColor()===""&&k.getValue()!=""){k.setValueStateText(d.getText("PALETTE_THRESHOLD_HAS_NO_COLOR"));if(!(k.getValueState()===sap.ui.core.ValueState.Error)){k.setValueState(sap.ui.core.ValueState.Error);this._updateOKButton({colorError:true});this._dirtyThresholdCount++;}return;}else{if(!f){if(k.getValue()!=""){k.setValueStateText(d.getText("PALETTE_INVALID_THRESHOLD"));if(!(k.getValueState()===sap.ui.core.ValueState.Error)){k.setValueState(sap.ui.core.ValueState.Error);this._updateOKButton({thresholdError:true});this._dirtyThresholdCount++;}return;}else{if(h.getColor()!==""&&k.getValue()===""){k.setValueStateText(d.getText("PALETTE_COLOR_HAS_NO_THRESHOLD"));if(!(k.getValueState()===sap.ui.core.ValueState.Error)){k.setValueState(sap.ui.core.ValueState.Error);this._updateOKButton({thresholdError:true});this._dirtyThresholdCount++;}return;}}}}if(k.getValueState()===sap.ui.core.ValueState.Error){k.setValueState(sap.ui.core.ValueState.None);this._dirtyThresholdCount--;}if(this._dirtyThresholdCount<=0){this._dirtyThresholdCount=0;this._updateOKButton({thresholdError:false,colorError:false});}},_updateThresholdArea:function(k){var h=this._getCurrentNumOfColors(),f=this._thresholdArea.getItems(),l=f.length,j;if(h>l){for(j=l;j<h;++j){var m=new sap.m.HBox();m.addItem(new sap.m.Label({text:d.getText("PALETTE_THRESHOLD_SEPARATOR")}));var g=new sap.m.Input({type:"Number"}).addStyleClass("sapLudsiThresholdInput");g.attachLiveChange(this._initiateValidation.bind(this));m.addItem(g);this._thresholdArea.addItem(m);}if(this.getGradientEnabled()){this._calculateThresholds();this._generateGradient(true);}}else{for(j=l-1;j>=h;--j){this._thresholdArea.removeItem(f[j]);}if(this.getGradientEnabled()){this._calculateThresholds();this._generateGradient(true,k);}}this._thresholdArea.rerender();},_createSwatchArea:function(){if(this.getIsEditThreshold()){this._swatchArea=new sap.m.VBox();}else{this._swatchArea=new sap.m.HBox();}this._colorSwatchGroup=new sap.m.ColorSwatchGroup();var h=this._getCurrentNumOfColors();if(this.getIsEditThreshold()){this._colorSwatchGroup.setColumns(1);}for(var g=0;g<h;++g){var f=new sap.m.ColorSwatch({radius:this._colorSwatchRadius,forceRect:this._forceRect});if(!this._currentSwatch){this._currentSwatch=f;}this._colorSwatchGroup.addSwatch(f);}this._colorSwatchGroup.attachChange(this._colorSwatchChanged.bind(this));if(this._existingColorFeed){this._colorSwatchGroup.setGroupColors(this._existingColorFeed.palette);}this._swatchArea.addItem(this._colorSwatchGroup);return this._swatchArea;},_createGradientCheckBoxArea:function(){var f=this.getGradientEnabled();this._gradCheckbox=new sap.m.CheckBox({text:d.getText("PALETTE_GENERATE_GRADIENT"),selected:f}).attachSelect(this._toggleGradient.bind(this));return this._gradCheckbox;},_createReverseArea:function(){var f=new sap.m.HBox();var g=new sap.m.Button({icon:sap.ui.core.IconPool.getIconURI("flip","fpa"),type:sap.m.ButtonType.Transparent,tooltip:d.getText("PALETTE_REVERSE")}).attachPress(this._reverse.bind(this));f.addItem(g);f.addItem(this._createRemoveColorArea());return f;},_createSaveArea:function(){this._save=new sap.m.CheckBox({text:d.getText("PALETTE_SAVE_AS_A_NEW_PALETTE"),selected:!(this.getIsCustomize()||this.getIsEditThreshold())}).attachSelect(this._saveToggle.bind(this));return this._save;},_saveToggle:function(g){var f=g.getSource().getSelected();this._nameArea.setVisible(f);if(f){this._validateName(this._nameInput.getValue());}else{this._updateOKButton({nameExists:false,nameEmpty:false});}},_createColorPickerArea:function(){this._colorPicker=new e();this._colorPicker.attachChange(this._colorPickerHexChanged.bind(this));this._colorSwatchGroup.setSelectedSwatch(this._currentSwatch);this._colorSwatchGroup.fireChange({selected:this._currentSwatch});return this._colorPicker;},_createRemoveColorArea:function(){this._removeColor=new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:sap.ui.core.IconPool.getIconURI("color-transparent","fpa"),tooltip:d.getText("PALETTE_REMOVE_COLOR")}).attachPress(this._removeColor.bind(this));return this._removeColor;},_createNameArea:function(){this._nameArea=new sap.m.HBox();var g=new sap.m.Label({text:d.getText("PALETTE_NAME")});this._nameArea.addItem(g);this._nameInput=new sap.m.Input({placeholder:d.getText("PALETTE_ENTER_COLOR_PALETTE_NAME"),width:"400px",valueStateText:d.getText("PALETTE_NAME_MUST_NOT_BE_EMPTY"),valueState:"Error"}).attachLiveChange(function(h){this._validateName(h.getSource().getValue());}.bind(this));if(this.getEditPalette()&&!this.getIsCustomize()){var f=this.getEditPalette().key;this._nameInput.setValue(f);this._nameInput.setValueState("None");this._nameInput.setEnabled(false);}this._nameArea.addItem(this._nameInput);return this._nameArea;},_validateName:function(f){if(f===""){this._nameInput.setValueState("Error");this._nameInput.setValueStateText(d.getText("PALETTE_NAME_MUST_NOT_BE_EMPTY"));this._updateOKButton({nameEmpty:true});}else{if(c&&c.getColorPaletteByKey(f)){this._nameInput.setValueState("Error");this._nameInput.setValueStateText(d.getText("PALETTE_ALREADY_EXISTS_GIVE_NEW"));this._updateOKButton({nameExists:true});}else{this._nameInput.setValueState("None");this._nameInput.setValueStateText("");this._updateOKButton({nameEmpty:false,nameExists:false});}}},_updateOKButton:function(h){if(h){var i=h.unsaveable;if(typeof i==="boolean"){this._unsaveable=i;}var f=h.nameEmpty;if(typeof f==="boolean"){this._nameEmpty=f;}var k=h.nameExists;if(typeof k==="boolean"){this._nameExists=k;}var g=h.paletteEmpty;if(typeof g==="boolean"){this._paletteEmpty=g;}var j=h.thresholdError;if(typeof j==="boolean"){this._thresholdError=j;}var m=h.colorError;if(typeof m==="boolean"){this._colorError=m;}var l=h.dirtyError;if(typeof l==="boolean"){this._dirtyError=l;}}if(this._unsaveable||this._nameEmpty||this._nameExists||this._paletteEmpty||this._thresholdError||this._colorError||this._dirtyError){this._okButton.setEnabled(false);this._okButton.setType(sap.m.ButtonType.Default);}else{this._okButton.setEnabled(true);this._okButton.setType(sap.m.ButtonType.Emphasized);}},_createTypeArea:function(){var f=new sap.m.HBox();var g=new sap.m.Label({text:d.getText("PALETTE_TYPE")});f.addItem(g);this._typeSelect=new sap.m.Select({items:[new sap.ui.core.Item({key:sap.ludsi.ColorPaletteType.CONTINUOUS,text:d.getText("PALETTE_CONTINUOUS")}),new sap.ui.core.Item({key:sap.ludsi.ColorPaletteType.SEQUENTIAL,text:d.getText("PALETTE_SEQUENTIAL")})]}).attachChange(this._typeChanged.bind(this));f.addItem(this._typeSelect);return f;},_createImportArea:function(){var f=new sap.m.HBox();this._importTextArea=new sap.m.TextArea();f.addItem(this._importTextArea);return f;},_createNumArea:function(){this._numArea=new sap.m.HBox();var g=new sap.m.Label({text:d.getText("PALETTE_NUMBER_OF_COLORS")});this._numArea.addItem(g);this._currentNumSelect=new sap.m.Select();var f=this._getMaxNumOfColors();for(var h=1;h<=f;++h){var j=new sap.ui.core.ListItem({text:""+h,key:h});if(!(this.getColorPaletteType()===sap.ludsi.ColorPaletteType.SEQUENTIAL&&h==1)){this._currentNumSelect.addItem(j);}}this._currentNumSelect.setSelectedKey(this._getCurrentNumOfColors(true));this._currentNumSelect.attachChange(this._currentNumChanged.bind(this));this._numArea.addItem(this._currentNumSelect);return this._numArea;},_getCurrentNumOfColors:function(f){if(f){if(this._existingColorFeed){if(this._existingColorFeed.numOfSegments){return this._existingColorFeed.numOfSegments;}else{if(this._existingColorFeed.palette){return this._existingColorFeed.palette.length;}else{return this._getMaxNumOfColors();}}}else{return this._getMaxNumOfColors();}}else{return parseInt(this._currentNumSelect.getSelectedKey(),10);}},_getMaxNumOfColors:function(){if(this.getColorPaletteType()===sap.ludsi.ColorPaletteType.QUALITATIVE){return 12;}else{return 9;}},_currentNumChanged:function(){var l=this._getCurrentNumOfColors(),f=this._colorSwatchGroup.getSwatches(),j=f.length,k=l-j,m=null,g;if(k<0){m=f[f.length-1].getColor();for(g=k;g<0;++g){this._colorSwatchGroup.popSwatch();}}else{for(g=0;g<k;++g){var h=new sap.m.ColorSwatch({radius:this._colorSwatchRadius,forceRect:this._forceRect});this._colorSwatchGroup.addSwatch(h);}}if(this.getIsEditThreshold()){this._updateThresholdArea(m);}if(this.getGradientEnabled()){this._generateGradient(true,m);}this._updateOKButton({dirtyError:false});this._currentSwatch=this._colorSwatchGroup.getSelectedSwatch();},_colorPickerHexChanged:function(g){var i=g.getParameters().hex.toLowerCase();var f=this._currentSwatch.getColor().toLowerCase();if(f!=i){this._updateOKButton({dirtyError:false,colorError:false});if(this._messageStrip.getVisible()){this._messageStrip.setVisible(false);}this._currentSwatch.setColor(i);if(f===""&&this.getIsEditThreshold()){var j=this._colorSwatchGroup.getSelectedIndex();this._validateThreshold(this._thresholdArea.getItems()[j].getItems()[1]);}this._currentSwatch.destroyTooltip();var h=this._colorSwatchGroup.getSelectedIndex();if(this._baseColorGroup){this._baseColorGroup.getSwatches()[h].setColor(i);this._baseName.setText(d.getText("PALETTE_CUSTOM_NAME"));}if(this.getColorPaletteType()==sap.ludsi.ColorPaletteType.SEQUENTIAL){if((h!=0)&&(h!=this._colorSwatchGroup.getSwatches().length-1)){if(this._dirtySwatches.indexOf(this._currentSwatch)===-1){this._dirtySwatches.push(this._currentSwatch);}this._gradCheckbox.setSelected(false);this._gradCheckbox.fireSelect({selected:false});this._toBeChecked=true;}else{if(!this._bSuppressGradient){this._generateGradient();}}}}else{return;}},_toggleGradient:function(f){var g=f.getParameter("selected");this.setGradientEnabled(g);if(this.getGradientEnabled()){this._calculateThresholds();this._generateGradient();this._updateOKButton({colorError:false,thresholdError:false,dirtyError:false});}},_generateGradient:function(k,i){if(!this.getGradientEnabled()){return;}var o=this._colorSwatchGroup.getGroupColorsWithEmpty(),l=o[0],h=o[o.length-1],j,g,n=false,m=this._getCurrentNumOfColors();if(k){j=this._colorSwatchGroup.getGroupColors();h=j[j.length-1];}if(i){h=i;}if(l==""||h==""){n=true;}if(n){if(l==""){g=b.singleGradient(h,m);g=g.reverse();}else{g=b.singleGradient(l,m);}}else{g=b.doubleGradient(l,h,m);}this._colorSwatchGroup.setGroupColors(g);if(this._baseColorGroup){var f={palette:g,key:d.getText("PALETTE_CUSTOM_NAME")};this._setBaseColor(f);}},_colorSwatchChanged:function(f){this._currentSwatch=f.getParameter("selected");var g=this._currentSwatch.getColor();if(g!=""&&g!=this._colorPicker.getColorString()){this._triggeredFromSwatch=true;this._colorPicker.setColorString(g);this._colorPicker.rerender();this._triggeredFromSwatch=false;}},_removeColor:function(){if(this._currentSwatch.getColor()!=""){this._updateOKButton({dirtyError:false});this._currentSwatch.setColor("");}this._currentSwatch.setTooltip(d.getText("PALETTE_ADD_COLOR"));if(this.getColorPaletteType()===sap.ludsi.ColorPaletteType.SEQUENTIAL){var f=this._dirtySwatches.indexOf(this._currentSwatch);if(f>-1){this._dirtySwatches.splice(f,1);}if(this._dirtySwatches.length==0&&this._getCurrentNumOfColors()!==2){if(this._toBeChecked){this._gradCheckbox.setSelected(true);this._gradCheckbox.fireSelect({selected:true});this._toBeChecked=false;}}this._generateGradient();if(this.getIsEditThreshold()){var g=this._colorSwatchGroup.getSelectedIndex();this._validateThreshold(this._thresholdArea.getItems()[g].getItems()[1]);}}if(this._colorSwatchGroup.getGroupColors().length===0){this._updateOKButton({colorError:true});}},_reverse:function(){this._bSuppressGradient=true;this._colorSwatchGroup.reverse();this._bSuppressGradient=false;this._updateOKButton({dirtyError:false});},_typeChanged:function(g){var i=this.getColorPaletteType();var h=g.getParameter("selectedItem").getKey();if(i===h){return;}this.setColorPaletteType(h);var f=true;this._numArea.setVisible(f);this._swatchArea.setVisible(f);},_okButtonPressed:function(){var f={},n={},g,k=[],m;f.key=this._nameInput.getValue();f.text=this._nameInput.getValue();f.paletteType=this.getColorPaletteType();f.palette=this._colorSwatchGroup.getGroupColors();if(this.getIsEditThreshold()){k.push(this._thresholds[0]);m=this._thresholdArea.getItems();for(g=0;g<m.length;++g){if(m[g].getItems()[1].getValue()!==""){k.push(m[g].getItems()[1].getValue());}}}f.custom=true;n.palette=f;if(k){for(g=0;g<k.length;++g){k[g]=parseFloat(k[g]);}n.legendValues=k;n.numOfSegments=k.length-1;}n.save=this._save.getSelected();if(n.legendValues[0]>n.legendValues[1]){var l;var j=0;for(var g=1;g<n.legendValues.length-1;g++){l=n.legendValues[g+1]-n.legendValues[g];j=j+l;}var o=j/(n.legendValues.length-2);n.legendValues[0]=Math.floor((n.legendValues[1]-o)/5)*5;}if(n.save&&c){var h=c.getColorPaletteByColors(f.palette);if(h&&h.key!=="Custom"){this._showError(d.getText("PALETTE_WITH_COLORS_ALREADY_EXISTS"));return;}}this.fireOk(n);this.close();this.destroy();},_cancelButtonPressed:function(){this.close();this.destroy();}});return sap.ludsi.CreatePaletteDialog;});