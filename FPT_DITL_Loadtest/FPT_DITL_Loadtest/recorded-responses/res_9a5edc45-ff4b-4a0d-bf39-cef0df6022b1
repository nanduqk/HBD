define("zen.rt.uiframework/inputcontrol/inputcontrolDialog",["zen.rt.uiframework/resources/js/MessageBundle","zen.rt.uiframework/inputcontrol/InputControlSegmentedButton","css!zen.rt.uiframework/resources/css/inputcontrolDialog.css"],function(a,c){var b=sap.m.Dialog.extend("sap.lumira.inputControlDialog",{metadata:{properties:{},aggregations:{},events:{}},renderer:{}});b.prototype.initiate=function(p,x,g,B,r,y,A){this.removeAllContent();this.removeAllButtons();var m=function(e,G){var E=e.split("&");for(var D=0;D<E.length;++D){var H=E[D];if(H.indexOf(G)!=-1){var F=H.split("=")[1];return F;}}return"";};var j=y;var v=m(g,"OPERATOR");var w=m(g,"DATATYPE");var z=unescape(m(g,"CHARACTERISTIC_NAME"));var i=parseInt(m(g,"VALUECOUNT"),10);var n="ALL";if(j!=null&&j!=undefined&&j.isChangeControl){v=j.operatorArray.toUpperCase();z=j.dimension_DisplayName;i=j.count;w=j.datatype;}if(undefined!=v){var u=v.split("::");var C=u.length;var q=(u.indexOf("EQUAL")!=-1||u.indexOf("EQ")!=-1||u.indexOf("NOTEQ")!=-1||u.indexOf("NOT EQUAL")!=-1);var o=(u.indexOf("BETWEEN")!=-1||u.indexOf("BT")!=-1||u.indexOf("NOTBT")!=-1||u.indexOf("NOT BETWEEN")!=-1);var f=(u.indexOf("GREATER_THAN")!=-1||u.indexOf("GT")!=-1||u.indexOf("LESS_THAN")!=-1||u.indexOf("LT")!=-1||u.indexOf("GREATER_EQUAL")!=-1||u.indexOf("GE")!=-1||u.indexOf("LESS_EQUAL")!=-1||u.indexOf("LE")!=-1);if(u=="COMPLEX"){n="COMPLEX";}else{if(C==1){if(q){if(w=="DATE"){if(i<=1){n="DATERADIO";}else{n="DATELIST";}}else{if(w=="NUMBER"&&!o){if(i<=1){n="RANGERADIO";}else{n="RANGELIST";}}else{if(i<=1){n="RADIO";}else{n="LIST";}}}}else{if(w=="DATE"){if(!o){n="DATERADIOSSD";}else{n="DATE";}}else{if(w=="NUMBER"&&!o){if(f){n="RANGERADIOSSD";}else{if(i<=1){n="RANGERADIO";}else{n="RANGE";}}}else{if(w=="NUMBER"&&o){n="RANGE";}else{n="TEXT";}}}}}else{if(C>1){if(q){if(w!="DATE"){if(i<=1){n="RADIO";}else{n="LIST";}}else{if(i<=1){n="DATERADIO";}else{n="DATELIST";}}}else{n="TEXT";}}else{n="TEXT";}}}}g+="&ENABLE="+n;if(j!=undefined){j.visualizationmode=n;}var d=function(){this.close();var e=this.oICDialogSegmentedButton.getSelectedKey(),G;if(e==="DROPDOWN"&&this.oICDialogSingleMultiRadioGroup.getSelectedButton().getText()===a.getText("SINGLE_INPUT_CONTROL")){e="SSD";}if(e==="LIST"&&this.oICDialogSingleMultiRadioGroup.getSelectedButton().getText()===a.getText("SINGLE_INPUT_CONTROL")){e="RADIO";}if(j!=null&&j!=undefined&&j.isChangeControl){var E={componentId:y.control_id,viz_mode:e,dimension_name:y.dimension_name,control_id:y.sControlId,control_type:y.zenControlType};G=l(e,g);E.width=G.width;E.height=G.height;sap.ui.getCore().getEventBus().publish("inputControlChangeEvent",E);}else{if(!p){G=l(e,"");g=g.split("&")[0];g=JSON.parse(g);var F=new sapbi_CommandSequence();F.addParameter(new sapbi_Parameter("BI_COMMAND_TYPE","GET_SNIPPET"));F.addParameter(new sapbi_Parameter("KEEP_SERVER_STATE","X"));var D=new sapbi_Command("CREATE_DIMENSION_FILTER_STORY");D.addParameter(new sapbi_Parameter("DATASETID",g.dsId));D.addParameter(new sapbi_Parameter("DIMENSION",unescape(g.dimensionName)));D.addParameter(new sapbi_Parameter("FILTERSCOPE","PAGE"));D.addParameter(new sapbi_Parameter("SCOPE",g.storyScope));D.addParameter(new sapbi_Parameter("ISINPUTCONTROL","X"));D.addParameter(new sapbi_Parameter("INPUTCONTROLVIZMODE",e));D.addParameter(new sapbi_Parameter("INPUTCONTROLWIDTH",G.width));D.addParameter(new sapbi_Parameter("INPUTCONTROLHEIGHT",G.height));D.addParameter(new sapbi_Parameter("TARGET_ITEM_REF","STORY"));if(B&&r){D.addParameter(new sapbi_Parameter("X_COR",B.pageX-r.left));D.addParameter(new sapbi_Parameter("Y_COR",B.pageY-r.top));}F.addCommand(D);sap.zen.request.zenSendCommandArrayWoEventWZenPVT(F,false,true);sap.ui.getCore().getEventBus().publish("inputControlCreateICEvent",{bNewIcCreated:true});}else{g=g.concat("&VISUALIZATION_MODE=").concat(e);G=l(e,g);g=g.concat("&WIDTH=").concat(G.width);g=g.concat("&HEIGHT=").concat(G.height);p.sendDrop(x,g,Math.round(B.pageX-r.left),Math.round(B.pageY-r.top));sap.ui.getCore().getEventBus().publish("inputControlCreateICEvent",{bNewIcCreated:true});}}};var t=function(D,E){var e=D.split("&");if(e.indexOf(E)!=-1){return true;}else{return false;}};var l=function(D,F){var E={};if(D==="TEXT"){var e=t(F,"ENABLE=RANGE");if(e){E.width=240;E.height=72;}else{E.width=240;E.height=72;}}if(D==="DROPDOWN"||D==="SSD"){E.width=240;E.height=72;}if(D==="DATE"){var G=t(F,"ENABLE=DATE");if(G){E.width=240;E.height=72;}else{E.width=240;E.height=72;}}if(D==="COMPLEX"){E.width=260;E.height=160;}if(D==="RANGE"){E.width=240;E.height=132;}if(D==="LIST"){E.width=240;E.height=196;}if(D==="RADIO"){E.width=240;E.height=196;}return E;};var k=function(){this.close();};this.titleLabel=new sap.m.Text({text:a.getText("INPUT_CONTROL_TITLE")+" :"}).addStyleClass("sapLudsiICTitleLabel");this.textInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("text","fpa"),tooltip:a.getText("TEXT_INPUT_CONTROL"),key:"TEXT",text:a.getText("TEXT_INPUT_CONTROL")});this.dropDownBoxInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("variance","fpa"),tooltip:a.getText("DROPDOWN_INPUT_CONTROL"),key:"DROPDOWN",text:a.getText("DROPDOWN_INPUT_CONTROL")});this.choiceInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("list-bulleted","fpa"),tooltip:a.getText("CHOICE_INPUT_CONTROL"),key:"LIST",text:a.getText("CHOICE_INPUT_CONTROL")});this.sliderInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("gauge-bar","fpa"),tooltip:a.getText("SLIDER_INPUT_CONTROL"),key:"RANGE",text:a.getText("SLIDER_INPUT_CONTROL")});this.dateInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("calendar","fpa"),tooltip:a.getText("DATE_INPUT_CONTROL"),key:"DATE",text:a.getText("DATE_INPUT_CONTROL")});this.complextInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("input-control","fpa"),tooltip:a.getText("COMPLEX_INPUT_CONTROL"),key:"COMPLEX",text:a.getText("COMPLEX_INPUT_CONTROL")});this.radioInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("outline","fpa"),tooltip:a.getText("RADIO_INPUT_CONTROL"),key:"RADIO",text:a.getText("RADIO_INPUT_CONTROL")});this.ssdInputControl=new sap.m.SegmentedButtonItem({icon:sap.ui.core.IconPool.getIconURI("options","fpa"),tooltip:a.getText("SSD_INPUT_CONTROL"),key:"SSD",text:a.getText("SSD_INPUT_CONTROL")});this.oICDialogSegmentedButton=new c({items:[this.textInputControl,this.dropDownBoxInputControl,this.choiceInputControl,this.sliderInputControl,this.dateInputControl,this.complextInputControl],width:"100%"}).addStyleClass("sapLudsiICSegmentedButton");this.oICDialogSingleMultiRadioGroup=new sap.m.RadioButtonGroup({columns:2});this.singleOption=new sap.m.RadioButton({text:a.getText("SINGLE_INPUT_CONTROL")});this.multiOption=new sap.m.RadioButton({text:a.getText("MULTI_INPUT_CONTROL")});this.oICDialogSingleMultiRadioGroup.addButton(this.singleOption).addButton(this.multiOption);this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.multiOption);this.oICDialogSegmentedButton.attachSelect(function(D){var e=D.getSource();if(e.getSelectedKey()==="DROPDOWN"||e.getSelectedKey()==="LIST"){this.oICDialogSingleMultiRadioGroup.setVisible(true);}else{this.oICDialogSingleMultiRadioGroup.setVisible(false);}}.bind(this));if(A!=null){if(A=="SSD"){A="DROPDOWN";}else{if(A=="RADIO"){A="LIST";}}}this.selectedDimension=new sap.m.Text({text:a.getText("INPUT_CONTROL_DIMENSION")+" : "+unescape(z)}).addStyleClass("sapLudsiICType");var s=v.replace(" ","_");this.appliedFilter=new sap.m.Text({text:a.getText("INPUT_CONTROL_FILTER")+" : "+a.getText(s)});var h=new sap.m.VBox();h.addItem(this.titleLabel);h.addItem(this.oICDialogSegmentedButton);h.addItem(this.oICDialogSingleMultiRadioGroup);h.addItem(this.selectedDimension);h.addItem(this.appliedFilter);this._okButton=new sap.m.Button({text:a.getText("IC_OK_BUTTON"),type:sap.m.ButtonType.Emphasized,press:d.bind(this)});this._cancelButton=new sap.m.Button({text:a.getText("IC_CANCEL_BUTTON"),press:k.bind(this)});this.handleSelection(g,j);this.addButton(this._okButton);this.addButton(this._cancelButton);this.setContentWidth("496px");this.setContentHeight("232px");this.addContent(h);this.setTitle(a.getText("INPUT_CONTROL_HEADER"));if(j!=null&&j!=undefined&&j.isChangeControl&&A!=undefined&&A!=null){this.oICDialogSegmentedButton.setSelectedKey(A);}this.onAfterRendering=function(){if(!this.lastZIndex){var e=new sap.zen.designmode.ZIndexProvider();this.lastZIndex=e.size();}this.$().css("z-index",this.lastZIndex);};if(!this.isOpen()){this.open();}};b.prototype.updateZIndex=function(){if(!this.lastZIndex){var d=new sap.zen.designmode.ZIndexProvider();this.lastZIndex=d.size();}this.$().css("z-index",this.lastZIndex);};b.prototype.getSelectedInputControlIndex=function(){return this.selectedICIndex;};b.prototype.setSelectedInputControlIndex=function(d){this.selectedICIndex=d;};b.prototype.handleSelection=function(m,d){var h="ALL";var l;var k=false;var f=m.split("&");if(f.indexOf("ISHIERARCHY=true")!=-1){k=true;}else{if(d!=null&&d.isHierarchy){k=true;}}if(d!=null&&d!=undefined&&d.isChangeControl){l=d.count;h=d.visualizationmode;if(d.count&&d.count<=1){if(h==="LIST"){h="RADIO";}if(h==="DATELIST"&&d.count===1){h="DATERADIO";}if(h==="DROPDOWN"){h="SSD";}}if(h==="RANGE"&&(d.operatorArray.toUpperCase()!="BT"&&d.operatorArray.toUpperCase()!="NOTBT")){h="RANGELIST";}var o=true;o=d.enableCancelButton;this._cancelButton.setEnabled(o);if(!o){this.titleLabel.setText(a.getText("INPUT_CONTROL_TITLE_CHANGE")+" :");this.attachBrowserEvent("keydown",function(p){if(p.which==27){p.preventDefault();p.stopPropagation();}});}}else{if(m!=undefined&&m!=null){var g=function(p,t){var r=p.split("&");for(var q=0;q<r.length;++q){var u=r[q];if(u.indexOf(t)!=-1){var s=u.split("=")[1];return s;}}return"";};l=parseInt(g(m,"VALUECOUNT"),10);var n=m.indexOf("ENABLE=");if(n!=-1){var e=m.substring(n);var j=e.indexOf("&");if(j!=-1){var i=e.substring(0,j);h=i.split("=")[1];}else{h=e.split("=")[1];}}}}switch(h){case"LIST":this.updateSelection(true,true,true,false,false,true,false,false,k,d);break;case"DATE":this.updateSelection(false,false,false,true,false,true,false,false,k,d);break;case"RANGE":this.updateSelection(true,false,false,false,true,true,false,false,k,d);break;case"TEXT":this.updateSelection(true,false,false,false,false,true,false,false,k,d);break;case"RANGELIST":this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.multiOption);this.multiOption.setEnabled(true);if(l<=1){this.singleOption.setEnabled(true);this.updateSelection(true,true,true,false,true,true,false,false,k,d);}else{this.singleOption.setEnabled(false);this.updateSelection(true,true,true,false,false,true,false,false,k,d);}break;case"RANGERADIO":this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.singleOption);this.multiOption.setEnabled(true);this.singleOption.setEnabled(true);this.updateSelection(true,true,true,false,true,true,true,true,k,d);break;case"RANGERADIOSSD":this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.singleOption);this.multiOption.setEnabled(false);this.singleOption.setEnabled(true);this.updateSelection(true,true,true,false,true,true,true,true,k,d);break;case"DATELIST":this.updateSelection(false,true,true,false,false,true,false,false,k,d);break;case"DATERADIO":this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.singleOption);this.multiOption.setEnabled(true);this.singleOption.setEnabled(true);this.updateSelection(false,true,true,true,false,true,true,true,k,d);break;case"DATERADIOSSD":this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.singleOption);this.multiOption.setEnabled(false);this.singleOption.setEnabled(true);this.updateSelection(false,true,true,true,false,true,true,true,k,d);break;case"COMPLEX":this.updateSelection(false,false,false,false,false,true,false,false,k,d);break;case"RADIO":this.updateSelection(true,true,true,false,false,true,true,true,k,d);break;case"ALL":this.updateSelection(true,true,true,true,true,true,true,true,k,d);break;default:this.updateSelection(true,true,true,true,true,true,true,true,k,d);}};b.prototype.updateSelection=function(g,d,l,i,m,f,j,h,k,e){this.textInputControl.setVisible(g);this.dropDownBoxInputControl.setVisible(l);this.choiceInputControl.setVisible(d);this.sliderInputControl.setVisible(m);this.dateInputControl.setVisible(i);this.complextInputControl.setVisible(f);this.singleOption.setEnabled(j);if(k){this.dropDownBoxInputControl.setVisible(false);this.textInputControl.setVisible(false);this.singleOption.setEnabled(false);this.oICDialogSegmentedButton.setSelectedKey("LIST");}else{if(g){this.oICDialogSegmentedButton.setSelectedKey("TEXT");this.oICDialogSingleMultiRadioGroup.setVisible(false);}else{if(l){this.oICDialogSegmentedButton.setSelectedKey("DROPDOWN");this.oICDialogSingleMultiRadioGroup.setVisible(true);}else{if(d){this.oICDialogSegmentedButton.setSelectedKey("LIST");this.oICDialogSingleMultiRadioGroup.setVisible(true);}else{if(m){this.oICDialogSegmentedButton.setSelectedKey("RANGE");this.oICDialogSingleMultiRadioGroup.setVisible(false);}else{if(i){this.oICDialogSegmentedButton.setSelectedKey("DATE");this.oICDialogSingleMultiRadioGroup.setVisible(false);}else{if(f){this.oICDialogSegmentedButton.setSelectedKey("COMPLEX");this.oICDialogSingleMultiRadioGroup.setVisible(false);}}}}}}}if(e!=null){if(e.zenControlType==="list_filter"||e.zenControlType==="dropdown_filter"){this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.multiOption);this.oICDialogSingleMultiRadioGroup.setVisible(true);}else{if(e.zenControlType==="ssd_filter"||e.zenControlType==="radio_filter"){this.oICDialogSingleMultiRadioGroup.setSelectedButton(this.singleOption);this.oICDialogSingleMultiRadioGroup.setVisible(true);}else{this.oICDialogSingleMultiRadioGroup.setVisible(false);}}}};return new b();});