/*
ï¿½2010 - 2016 SAP SE or an SAP affiliate company.  All rights reserved.
 
SAP and other SAP products and services mentioned herein as well as their respective logos are trademarks or registered trademarks of SAP SE in Germany and other countries.  Please see http://www.sap.com/corporate-en/legal/copyright/index.epx#trademark for additional trademark information and notices.
*/

jQuery.sap.declare({modName:"com.sap.fioribi.components.overviewpage.MyHomePageSectionView",type:"view"});jQuery.sap.require({modName:"com.sap.fioribi.modules.common.BILPView",type:"view"});jQuery.sap.require("com.sap.fioribi.widgets.Table");com.sap.fioribi.components.overviewpage.MyHomePageSectionView=function(){com.sap.fioribi.modules.common.BILPView.apply(this,arguments);BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/SmartFilterBar.css");};com.sap.fioribi.components.overviewpage.MyHomePageSectionView.prototype=jQuery.sap.newObject(com.sap.fioribi.modules.common.BILPView.prototype);com.sap.fioribi.components.overviewpage.MyHomePageSectionView.prototype.getControllerName=function(){return"com.sap.fioribi.components.overviewpage.DocumentsController";};com.sap.fioribi.components.overviewpage.MyHomePageSectionView.prototype.handlePressEvent=function(e,oController,id){var title="";if(id.includes("_")){id=id.split("_")[0];}switch(id){case"Documents":title=BILaunchpadApp.localized("tile_header_text_documents");break;case"Schedules":title=BILaunchpadApp.localized("tile_header_text_schedules");break;case"Categories":title=BILaunchpadApp.localized("tile_header_text_categories");break;case"Inbox":title=BILaunchpadApp.localized("tile_header_text_Myinbox");break;case"Folders":title=BILaunchpadApp.localized("tile_header_text_folders");break;case"RecycleBin":title=BILaunchpadApp.localized("tile_header_text_deleted");break;default:title=BILaunchpadApp.localized("tile_header_text_All_Documents");}var customObjContext={children:"0",created:"",cuid:"",description:"",displaytype:"BI Workspace",fav:true,filter:"home_myfavorites",headerIconClass:"BILP-size32px BILP-Webi",icon:"",id:id,imagepath:"",instances:"0",keywords:"",lastRef:"",lastRun:"",name:title,opendocurl:"",owner:"Administrator",parentcuid:"",parentid:"",tileType:"doc",type:"AFDashboardPage",updated:"",dcoViewId:""};if(e!=null){src=e.getSource();}var objContext=this.data().context;if(!objContext){objContext={getProperty:function(obj){return customObjContext;},getPath:function(){return customObjContext;}};}sap.ui.core.BusyIndicator.show(0);setTimeout(function(){oController.fnViewDocument(objContext);sap.ui.core.BusyIndicator.hide();},10);};com.sap.fioribi.components.overviewpage.MyHomePageSectionView.prototype.createContent=function(oController){var $view=this;var uiElementMap=new Map();isTileClick=true;BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Common.css");if(BILaunchpadApp.getRtlFlag()==false){BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Homepage.css");}else{BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Homepage_rtl.css");}var myHomePage=new sap.m.Page({showHeader:false});myHomePage.addStyleClass("BILP-pageHeight BILP-transparent BILP-homeTabWidth BILP-TileLayout ");var oTileContainer=new sap.m.ScrollContainer({}).addStyleClass("BILP-Height100Perc");var jsonData={entries:[{icon:"sap-icon://folder",type:"AFDashboardPage",name:BILaunchpadApp.localized("tile_header_text_folders"),id:"Folders",footer:BILaunchpadApp.localized("tile_text_folder_listed")},{icon:"sap-icon://tag",type:"AFDashboardPage",name:BILaunchpadApp.localized("tile_header_text_categories"),id:"Categories",footer:BILaunchpadApp.localized("pagepreference_categories")},{icon:"sap-icon://document",type:"AFDashboardPage",name:BILaunchpadApp.localized("tile_header_text_documents"),id:"Documents",footer:BILaunchpadApp.localized("search_documents")},{icon:"sap-icon://email",type:"AFDashboardPage",name:BILaunchpadApp.localized("tile_header_text_inbox"),id:"Inbox",footer:BILaunchpadApp.localized("tile_text_unread_items")},{icon:"sap-icon://instance",type:"AFDashboardPage",name:BILaunchpadApp.localized("tile_header_text_schedules"),id:"Schedules",footer:BILaunchpadApp.localized("tile_text_items")},{icon:"sap-icon://delete",type:"AFDashboardPage",name:BILaunchpadApp.localized("tile_header_text_deleted"),id:"RecycleBin",footer:BILaunchpadApp.localized("tile_text_deleted_items")}]};var tileList2=new sap.ui.model.json.JSONModel(jsonData);var homepageTilesModel=sap.ui.getCore().getModel("docCount");var modelRef=new sap.ui.model.json.JSONModel(homepageTilesModel);BILaunchpadApp.setdocumentsCount(modelRef.oData.documentcount);var oRightsObj=BILaunchpadApp.getRightsObject();var homePagePref=sap.ui.getCore().getModel("homePagePrefModel");var setPagePreference=function(jsonData){homePagePref=jsonData;sap.ui.getCore().setModel(homePagePref,"homePagePrefModel");};var errorPagePreference=function(xhr,ajaxOptions,thrownError){console.log("error");};var request={surl:BILaunchpadApp.getWebServiceBaseURL()+"/internal/v1/settings/userpreferences/homepagepreference",reqType:"GET",bAsync:false,successHandler:setPagePreference,errorHandler:errorPagePreference,headers:{Accept:"application/json","Content-Type":"application/json;odata=verbose","x-sap-logontoken":BILaunchpadApp.getlogonToken()}};jQuery.sap.require("com.sap.fioribi.utils.RequestDispatcher");var reqDispatcherPref=new RequestDispatcher();reqDispatcherPref.sendRequest(request);var tileMap={};for(var i=0;i<jsonData.entries.length;i++){var flag=false;if(jsonData.entries[i].id=="Documents"){if(homePagePref.alldoc){flag=true;}}if(jsonData.entries[i].id=="Schedules"){if(homePagePref.schedules){flag=true;}}if(jsonData.entries[i].id=="Categories"){if(homePagePref.categories){flag=true;}}if(jsonData.entries[i].id=="Inbox"){if(oRightsObj.alertview||oRightsObj.inboxview){if(homePagePref.biinbox){flag=true;}}}if(jsonData.entries[i].id=="Folders"){if(oRightsObj.favoritefolderview||oRightsObj.folderview){if(homePagePref.folders){flag=true;}}}if(jsonData.entries[i].id=="RecycleBin"){if(oRightsObj.recyclebinview){if(homePagePref.recyclebin){flag=true;}}}if(flag){var tileContent=new sap.m.TileContent({content:[new sap.m.VBox({items:[new sap.ui.core.Icon({src:(function(){switch(jsonData.entries[i].id){case"Documents":return jsonData.entries[i].icon;break;case"Schedules":return jsonData.entries[i].icon;break;case"Categories":return jsonData.entries[i].icon;break;case"Inbox":return jsonData.entries[i].icon;break;case"Folders":return jsonData.entries[i].icon;break;case"RecycleBin":return jsonData.entries[i].icon;}})(),size:"2rem"}).addStyleClass("sapUiNoMargin BILP-TileRefreshIconcolor"),],alignItems:sap.m.FlexAlignItems.End}).addStyleClass("BILP-VBox")]});var tileRandomId=Math.floor(Math.random()*90000)+10000;var allDoc=new sap.m.GenericTile({id:jsonData.entries[i].id,header:jsonData.entries[i].name,tooltip:" ",tileContent:[tileContent],press:function(event){if(isTileClick){BILaunchpadApp.setFavFolderSelected("false");$view.handlePressEvent(event,oController,event.getSource().sId);}else{isTileClick=true;}}}).addStyleClass("sapUiTinyMarginBegin sapUiTinyMarginTop footertext");tileMap[jsonData.entries[i].id]=allDoc;if(homePagePref.hometileOrderArray==undefined||homePagePref.hometileOrderArray==null||homePagePref.hometileOrderArray==""){oTileContainer.addContent(allDoc);}}}if(homePagePref.hometileOrderArray!=undefined){var homeTileOrderArr=homePagePref.hometileOrderArray.split(",");for(var i=0;i<homeTileOrderArr.length;i++){if(tileMap[homeTileOrderArr[i]]!=undefined){oTileContainer.addContent(tileMap[homeTileOrderArr[i]]);}}}return oTileContainer;};