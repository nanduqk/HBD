/*
ï¿½2010 - 2016 SAP SE or an SAP affiliate company.  All rights reserved.
 
SAP and other SAP products and services mentioned herein as well as their respective logos are trademarks or registered trademarks of SAP SE in Germany and other countries.  Please see http://www.sap.com/corporate-en/legal/copyright/index.epx#trademark for additional trademark information and notices.
*/

jQuery.sap.declare({modName:"com.sap.fioribi.components.categories.CreateCategoryView",type:"view"});jQuery.sap.require({modName:"com.sap.fioribi.modules.common.BILPView",type:"view"});com.sap.fioribi.components.categories.CreateCategoryView=function(oData){this.typeParent=null;if(oData.typeParent!=null){this.typeParent=oData.typeParent;}com.sap.fioribi.modules.common.BILPView.apply(this,arguments);};com.sap.fioribi.components.categories.CreateCategoryView.prototype=jQuery.sap.newObject(com.sap.fioribi.modules.common.BILPView.prototype);com.sap.fioribi.components.categories.CreateCategoryView.prototype.getControllerName=function(){return"com.sap.fioribi.components.categories.CreateCategoryController";};com.sap.fioribi.components.categories.CreateCategoryView.prototype.createContent=function(oController){var $this=this;$this.checkUpload=0;var sampleText=BILaunchpadApp.localized("sample_category");BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Categories.css");jQuery.sap.require("com.sap.fioribi.widgets.PreviewTile");this.image_preview=new sap.m.Image({src:"com/sap/fioribi/images/personal-category.png",});this.previewTile=new com.sap.fioribi.widgets.PreviewTile(this.image_preview,sampleText,oController);var oHbox2=new sap.m.HBox({items:[this.previewTile.getTileContent()]}).addStyleClass("BILP-previewBox");var oController=this.getController();var name;var desc="";var tags="";var kind="PersonalCategory";var color="#000000";var previewLabel=new sap.m.Title({text:BILaunchpadApp.localized("preview"),textAlign:sap.ui.core.TextAlign.Left,level:sap.ui.core.TitleLevel.H5,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"})});var accountLabel=new sap.m.Label({text:BILaunchpadApp.localized("category_name"),textAlign:sap.ui.core.TextAlign.Right,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"})}).addStyleClass(" BILP-categoryLabel ");var accountTextField=new sap.m.Input({value:BILaunchpadApp.localized("sample_category"),width:"100%",enabled:true,tooltip:BILaunchpadApp.localized("category_name"),layoutData:new sap.ui.layout.GridData({span:"L6 M6 S12"}),liveChange:function(oEvent){if(this.getValue()==""||!(/\S/.test(this.getValue()))){this.setValueState(sap.ui.core.ValueState.Error);this.setValueStateText(BILaunchpadApp.localized("no_category_label"));$this.previewTile.setTitle("");sap.ui.getCore().byId("category_save").setEnabled(false);}else{name=this.getValue();$this.previewTile.setTitle(name);this.setValueState(sap.ui.core.ValueState.None);sap.ui.getCore().byId("category_save").setEnabled(true);}},accessibleRole:sap.ui.core.AccessibleRole.Textbox,ariaLabelledBy:accountLabel});name=accountTextField.getValue();var descLabel=new sap.m.Label({text:BILaunchpadApp.localized("description"),textAlign:sap.ui.core.TextAlign.Right,required:false,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"})}).addStyleClass(" BILP-categoryPadding1 BILP-categoryLabel ");var descTextField=new sap.m.TextArea({maxLength:1024,width:"103%",enabled:true,tooltip:BILaunchpadApp.localized("description"),layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12"}),ariaLabelledBy:descLabel,change:function(oEvent){desc=oEvent.getSource().getProperty("value");}}).addStyleClass("BILP-categoryPadding1  BILP-dialogBoxTextAreas-scroll");var uploadLabel=new sap.m.Label({text:BILaunchpadApp.localized("Upload_Image"),textAlign:sap.ui.core.TextAlign.Right,required:false,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"})}).addStyleClass("BILP-categoryPadding1 BILP-categoryLabel BILP-categoryDialog");this.uploadFileModel_cat=new sap.ui.model.json.JSONModel();var ofile={entries:[]};this.uploadFileModel_cat.setData(ofile);var that=this;this.oFileUploader=new sap.ui.unified.FileUploader({icon:"sap-icon://add",iconOnly:true,tooltip:BILaunchpadApp.localized("upload_file"),uploadUrl:"",fileType:"png,jpeg,jpg,gif,svg",mimeType:"image/png,image/jpeg,image/jpg,image/gif,image/svg",uploadOnChange:false,useMultipart:true,sendXHR:true,maximumFileSize:0.1,sameFilenameAllowed:true,width:"100%",placeholder:BILaunchpadApp.localized("choose_file_to_upload"),fileSizeExceed:function(oEvent){var sName=oEvent.getParameter("fileName");var fSize=oEvent.getParameter("fileSize");var FSizeinKB=fSize*1024;sap.m.MessageToast.show(BILaunchpadApp.localized("upload_size_error"));},typeMissmatch:function(oEvent){var sName=oEvent.getParameter("fileName");var sType=oEvent.getParameter("fileType");var sMimeType=that.oFileUploader.getMimeType();if(!sMimeType){sMimeType=that.oFileUploader.getFileType();}sap.m.MessageToast.show(BILaunchpadApp.localized("upload_type_error")+" "+sMimeType+".");},change:function(oEvent){var fileReader=new FileReader();fileReader.onload=function(readerEvent){that.sImageData=readerEvent.target.result;if(that.sImageData=="data:"){that.sImageData=undefined;that.oFileUploader.setValue("");sap.m.MessageToast.show(BILaunchpadApp.localized("upload_empty_file"));}else{sap.m.MessageToast.show(BILaunchpadApp.localized("upload_success"));}that.image_preview.setSrc(that.sImageData);if(accountTextField.getValue()!=null){$this.previewTile.setImage(that.image_preview.getSrc());$this.previewTile.editBox.addItem($this.previewTile.editIcon);$this.checkUpload=1;}};fileReader.readAsDataURL(oEvent.getParameters()["files"][0]);sap.m.MessageToast.show(BILaunchpadApp.localized("upload_success"));},uploadProgress:function(oEvent){oTopBarDialog.setBusy(true);},uploadComplete:function(oEvent){oTopBarDialog.close();oControl.updateTable(oControl.currentParentID);oTopBarDialog.destroyContent();},ariaLabelledBy:uploadLabel}).addStyleClass(" BILP-imageBox BILP-Refreshicon ");var tagsLabel=new sap.m.Label({text:BILaunchpadApp.localized("add_tags"),textAlign:sap.ui.core.TextAlign.Right,required:false,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"})}).addStyleClass("BILP-categoryPadding1 BILP-categoryLabel BILP-categoryDialog");var tagsTextField=new sap.m.Input({placeholder:BILaunchpadApp.localized("use_comma_to_add_multiple_tags"),width:"100%",enabled:true,tooltip:BILaunchpadApp.localized("add_tags"),layoutData:new sap.ui.layout.GridData({span:"L6 M6 S12"}),change:function(oEvent){tags=oEvent.getSource().getProperty("value");},accessibleRole:sap.ui.core.AccessibleRole.Textbox,ariaLabelledBy:tagsLabel}).addStyleClass("BILP-categoryPadding ");var typeLabel=new sap.m.Label({text:BILaunchpadApp.localized("type"),textAlign:sap.ui.core.TextAlign.Right,required:false,layoutData:new sap.ui.layout.GridData({span:"L3 M3 S12"})}).addStyleClass("BILP-categoryPadding1 BILP-categoryDialog BILP-categoryLabel  ");var typeField=new sap.m.Select({width:"100%",tooltip:BILaunchpadApp.localized("type"),change:function(oEvent){kind=oEvent.getSource().getSelectedItem().getKey();if(kind=="Category"){$this.previewTile.setOption(BILaunchpadApp.localized("corp_category"));}else{$this.previewTile.setOption(BILaunchpadApp.localized("PersonalCategory"));}if(kind=="Category"&&($this.checkUpload==0||$this.previewTile.getUploadFlag()==0)){$this.image_preview.setSrc("com/sap/fioribi/images/corporate-category.png");$this.previewTile.setImage($this.image_preview.getSrc());}if(kind=="PersonalCategory"&&($this.checkUpload==0||$this.previewTile.getUploadFlag()==0)){$this.image_preview.setSrc("com/sap/fioribi/images/personal-category.png");$this.previewTile.setImage($this.image_preview.getSrc());}},ariaLabelledBy:typeLabel}).addStyleClass("BILP-categoryType");if(this.typeParent==null){oItem1=new sap.ui.core.Item({text:BILaunchpadApp.localized("personal_category"),key:"PersonalCategory"});oItem2=new sap.ui.core.Item({text:BILaunchpadApp.localized("Category"),key:"Category"});typeField.removeAllItems();typeField.addItem(oItem1);typeField.addItem(oItem2);}else{var localized_key;if($this.typeParent=="Corporate_Categories"){localized_key="Corporate_Category_type";}else{localized_key=$this.typeParent;}oItem1=new sap.ui.core.Item({text:BILaunchpadApp.localized(localized_key),key:$this.typeParent});kind=$this.typeParent;typeField.removeAllItems();typeField.addItem(oItem1);if(oItem1.getKey()=="Corporate_Categories"){$this.previewTile.setOption(BILaunchpadApp.localized("corp_category"));}else{$this.previewTile.setOption(BILaunchpadApp.localized("PersonalCategory"));}}BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/GenericTile.css");var oDialog=new sap.m.Dialog({afterClose:function(){this.destroyBeginButton();this.destroyEndButton();},title:BILaunchpadApp.localized("create_category"),content:[previewLabel,oHbox2,accountLabel,accountTextField,descLabel,descTextField,typeLabel,typeField,tagsLabel,tagsTextField,uploadLabel,this.oFileUploader],beginButton:new sap.m.Button({id:"category_save",text:BILaunchpadApp.localized("text_Save"),press:function(){if(name==""||name==null){sap.m.MessageToast.show(BILaunchpadApp.localized("text_popupnoname"));}else{oController.createCategory(name,desc,tags,kind,that.sImageData);jQuery.sap.require("com.sap.fioribi.widgets.GenericTile");oDialog.close();accountTextField.setValue(null);descTextField.setValue(null);tagsTextField.setValue(null);typeField.setSelectedKey("PersonalCategory");name="";desc="";tags="";kind="PersonalCategory";}}}),endButton:new sap.m.Button({text:BILaunchpadApp.localized("text_Cancel"),press:function(){oDialog.close();accountTextField.setValue(null);descTextField.setValue(null);tagsTextField.setValue(null);typeField.setSelectedKey("PersonalCategory");name;desc="";tags="";kind="PersonalCategory";}})}).addStyleClass("BILP-propertiesDialogbox sapUiSizeCompact BILP-footerpadding");var theme=BILaunchpadApp.getTheme();if(theme!=null&&theme==BILaunchpadApp.oConstants.CONTRASTBLACK_THEME){oDialog.addStyleClass("BILP-sap_belize_hcbBackgroundColor");}oDialog.open();};