/*
ï¿½2010 - 2016 SAP SE or an SAP affiliate company.  All rights reserved.
 
SAP and other SAP products and services mentioned herein as well as their respective logos are trademarks or registered trademarks of SAP SE in Germany and other countries.  Please see http://www.sap.com/corporate-en/legal/copyright/index.epx#trademark for additional trademark information and notices.
*/

var sendPingRequest=false;var delayedPing=false;function requestPingServer(){var IsUseInternalBiprwsCallBack=findCallback("callbackIsUseInternalBiprws");if(IsUseInternalBiprwsCallBack!=null&&IsUseInternalBiprwsCallBack()){return;}if(sendPingRequest&&!delayedPing){delayedPing=true;pingToBOEServer();sendPingRequest=false;setTimeout(function(){delayedPing=false;requestPingServer();},90000);}}function pingToBOEServer(){var randomNum=Math.round(Math.random()*10000);sendXmlHttpGet("../FioriBI/keepBOESessionAlive.jsp?random="+randomNum,true);}function sendXmlHttpGet(Url,asyncFlag){var xmlHttp;try{xmlHttp=new XMLHttpRequest();}catch(e){try{xmlHttp=new ActiveXObject("Msxml2.XMLHTTP");}catch(e){try{xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");}catch(e){return false;}}}var async=true;if(asyncFlag!="undefined"&&asyncFlag!=null){async=asyncFlag;}xmlHttp.open("GET",Url,async);xmlHttp.send();}function RequestDispatcher(){jQuery.sap.declare("com.sap.fioribi.common.RequestDispatcher");jQuery.sap.require("com.sap.fioribi.utils.SessionTimeout");function findCallback(name){try{if(name!=""){var mywin=window;if(mywin[name]){return mywin[name];}if(mywin.opener){mywin=mywin.opener;}else{if(mywin.parent){mwyin=mywin.parent;}else{return null;}}while(mywin){if(mywin[name]){return mywin[name];}if(mywin==mywin.parent){if(mywin.opener){mywin=mywin.opener;}else{return null;}}else{mywin=mywin.parent;}}}}catch(exception){}return null;}this.sendRequest=function(oRequest){var busy=new sap.m.BusyIndicator();var surl=oRequest.surl;var tokVal1=findCallback("callbackGetBTTOKEN2");var tokVal;if(tokVal1!=null){tokVal=tokVal1();}if(surl!=undefined&&surl!=null){if(surl.indexOf("v1/notification/now")<0&&surl.indexOf("BOETimeoutPing")<0){sendPingRequest=true;requestPingServer();}}if(BILaunchpadApp.oConstants){if(surl.indexOf("pagesize")<0){if(surl.indexOf("?")<0){surl=surl+"?pagesize="+BILaunchpadApp.oConstants.PAGESIZE_DEFAULT;}else{surl=surl+"&pagesize="+BILaunchpadApp.oConstants.PAGESIZE_DEFAULT;}}}var IsUseInternalBiprwsCallBack=findCallback("callbackIsUseInternalBiprws");if(IsUseInternalBiprwsCallBack!=null&&IsUseInternalBiprwsCallBack()){if(surl!=undefined&&surl!=null){if(surl.indexOf("v1/notification/now")>0){if(surl.indexOf("?")<0){surl=surl+"?notification=true&resetCountdown=false&logoff=false&appKind=InfoView";}else{surl=surl+"&notification=true&resetCountdown=false&logoff=false&appKind=InfoView";}}}}var reqType=oRequest.reqType===null?"POST":oRequest.reqType;var data=oRequest.data;var oContentType=oRequest.oContentType===null?"application/json;odata=verbose":oRequest.oContentType;var headers=oRequest.headers;if((headers.CSRF_TOKEN_COOKIE==undefined||headers.CSRF_TOKEN_COOKIE==null)&&reqType==="POST"){headers.CSRF_TOKEN_COOKIE=tokVal;}if(BILaunchpadApp){if(headers["X-SAP-PVL"]==undefined||headers["X-SAP-PVL"]==null){headers["X-SAP-PVL"]=BILaunchpadApp.getPreferredViewingLocale();}}var fnSuccess=oRequest.successHandler;var fnError=oRequest.errorHandler;var fnBeforeSend=oRequest.beforeSend;var bAsync=true;if(oRequest.bAsync!=undefined){bAsync=oRequest.bAsync;}$.ajax({cache:false,url:surl,type:reqType,data:data,async:bAsync,jsonp:false,contentType:oContentType,headers:headers,beforeSend:function(xhr){$("#busy").show();if(oRequest.beforeSend!=undefined){fnBeforeSend(xhr);}},complete:function(){$("#busy").hide();},success:function(data,textStatus,xhr){if(xhr!=undefined&&xhr!=null){if(xhr.status!=undefined&&xhr.status!=null&&((xhr.status>=200&&xhr.status<300)||xhr.status==304)){if(data!=null&&data!=undefined){if(data.error_code!=null){fnError(data);}else{fnSuccess(data,textStatus,xhr);}}}else{fnError(data);}}},error:function(xhr,textStatus,thrownError){var oData={message:BILaunchpadApp.localized("generic_error")};if(xhr!=undefined&&xhr!=null){if(xhr.responseJSON!=null&&xhr.responseJSON!=undefined){if(xhr.responseJSON.error_code!=null&&(xhr.responseJSON.error_code=="FWM 01002"||xhr.responseJSON.error_code=="RWS 00008"||xhr.responseJSON.error_code=="FWB 00003")){showSessionDialog();BILaunchpadApp.setSessionTimeOut(true);}else{fnError(xhr.responseJSON);}}else{if(xhr.responseText!=null&&xhr.responseText!=undefined){fnError(xhr.responseText);}else{fnError(oData);}}}else{fnError(oData);}}});};}