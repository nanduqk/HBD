/*
ï¿½2010 - 2016 SAP SE or an SAP affiliate company.  All rights reserved.
 
SAP and other SAP products and services mentioned herein as well as their respective logos are trademarks or registered trademarks of SAP SE in Germany and other countries.  Please see http://www.sap.com/corporate-en/legal/copyright/index.epx#trademark for additional trademark information and notices.
*/

jQuery.sap.declare("com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler");com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler=function(oPlaformActionHandler){this.oPlatformActionHandler=oPlaformActionHandler;this.oClientActionHandler=null;this.oCAFImplClassMap=[];this.sInfoObjectType=null;this.bgImageflag=false;var eventBus=sap.ui.getCore().getEventBus();eventBus.subscribe(BILaunchpadApp.oConstants.PLATFORM_EXTERNAL_CHANNEL,BILaunchpadApp.oConstants.CHILD_DOCUMENT_OPENDOC,this.openChildDocument,this);};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.getCAFImpl=function(CAFActionName,isOpenDoc){try{if(CAFActionName){CAFActionName=CAFActionName.replace(/\./g,"_");}var sDomain=CAFActionName.split("_")[0];var bundlePath=this.oClientActionHandler.getBundlePath(BILaunchpadApp.oConstants.VIEW);if(isOpenDoc){bundlePath={folder:"com.sap.fioribi.caf.unifiedviewer.platform",files:[]};}var aFilePath=bundlePath.files;var sFolder=bundlePath.folder;var sFilePath="";for(var i=0;i<aFilePath.length;i++){if(aFilePath[i].indexOf(CAFActionName+".js")!=-1){sFilePath=aFilePath[i].slice(0,-3);break;}}if(sFilePath==""){sFilePath=sFolder+"."+CAFActionName;}if(sFilePath=="com.sap.fioribi.caf.unifiedviewer.platform.Webi_Viewer"){jQuery.sap.require("com.sap.fioribi.pathresolver.WebiIMPLPathResolver");sFilePath="com.sap.webi.caf.unifiedviewer.Webi_Viewer";}if(CAFActionName!="AFDashboardPage_Viewer"){jQuery.sap.require(sFilePath);}var className=BILaunchpadApp.oBILaunchpadUtil.getClassName(sFilePath);var oInstance=new className();this.oCAFImplClassMap.push(oInstance);return oInstance;}catch(e){}};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.updateLatestInstanceObjectData=function(oData){var instanceObjData={};var oTempData=oData;var isOneSucess=false;instanceObjData.type=oData.type;instanceObjData.displaytype=oData.displaytype;instanceObjData.boe=oData.boe;instanceObjData.actId=oData.actId;instanceObjData.actiontechname=oData.actiontechname;instanceObjData.pageId=oData.pageId;instanceObjData.title=oData.title;instanceObjData.autosaveoriginaldocid=oData.autosaveoriginaldocid;var updateData=function(obj){instanceObjData.id=obj.id;instanceObjData.cuid=obj.cuid;instanceObjData.description=obj.description;instanceObjData.updated=obj.updated;instanceObjData.name=obj.name;instanceObjData.ownerid=obj.ownerid;instanceObjData.type=obj.type;};var reqDispatcher=new RequestDispatcher();var updateSuccess=function(oResponseJson){if(oResponseJson&&oResponseJson.entries.length>0){for(var i=0;i<oResponseJson.entries.length;i++){if(oResponseJson.entries[i].SI_SCHEDULE_STATUS==1){var objData={};objData.id=oResponseJson.entries[i].SI_ID;objData.cuid=oResponseJson.entries[i].SI_CUID;objData.description=oResponseJson.entries[i].SI_DESCRIPTION;objData.updated=oResponseJson.entries[i].SI_UPDATED_TS;objData.name=oResponseJson.entries[i].SI_NAME;objData.ownerid=oResponseJson.entries[i].SI_OWNERID;objData.type=oResponseJson.entries[i].SI_KIND;isOneSucess=true;updateData(objData);break;}}if(!isOneSucess){updateData(oTempData);}}else{updateData(oTempData);}};var updateFailed=function(xhr,ajaxOptions,thrownError){updateData(oTempData);};var sData="SELECT SI_NAME, SI_ID, SI_CUID, SI_OWNERID, SI_UPDATED_TS, SI_DESCRIPTION, SI_KIND, SI_SCHEDULE_STATUS FROM CI_INFOOBJECTS WHERE SI_PARENTID='"+oData.id+"' ORDER BY SI_CREATION_TIME DESC";var dataPost={query:sData};dataPost=JSON.stringify(dataPost);var urlCONS=BILaunchpadApp.getWebServiceBaseURL()+"/v1/cmsquery?page=1&pagesize=500";var request={surl:urlCONS,reqType:"POST",bAsync:false,data:dataPost,successHandler:updateSuccess,errorHandler:updateFailed,headers:{"x-SAP-logonToken":BILaunchpadApp.getlogonToken(),Accept:"application/json","Content-Type":"application/json;odata=verbose",}};reqDispatcher.sendRequest(request);return instanceObjData;};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.isSmartViewLatestInstance=function(objData){if(objData.type=="Webi"){var sData="";if(objData.type=="Webi"){var sWebiApplication="AVIDtyVgkkRGsYRNac8iUM0";sData="SELECT SI_WEBI_APPLICATION_PROPERTIES FROM CI_INFOOBJECTS,CI_SYSTEMOBJECTS,CI_APPOBJECTS WHERE SI_CUID='"+sWebiApplication+"'";}else{sData="SELECT SI_CRCONFIG_BI_LAUNCH_PAD FROM CI_INFOOBJECTS,CI_APPOBJECTS,CI_SYSTEMOBJECTS WHERE SI_KIND LIKE 'CRConfig'";}var reqDispatcher=new RequestDispatcher();var oResponseJson=null;var dataPost={query:sData};dataPost=JSON.stringify(dataPost);var fnSuccess=function(oResponse){oResponseJson=oResponse;};var fnError=function(xhr,ajaxOptions,thrownError){};var urlCONS=BILaunchpadApp.getWebServiceBaseURL()+"/v1/cmsquery";var request={surl:urlCONS,reqType:"POST",bAsync:false,data:dataPost,successHandler:function(data,textStatus,xhr){fnSuccess(data,textStatus,xhr);},errorHandler:function(){fnError();},headers:{Accept:"application/json","Content-Type":"application/json;odata=verbose","x-sap-logontoken":BILaunchpadApp.getlogonToken()}};reqDispatcher.sendRequest(request);var isLatestInstanceSelected=true;if(objData.type=="Webi"){var data=oResponseJson.entries[0];var appProperties=data.SI_WEBI_APPLICATION_PROPERTIES;var propLen=appProperties.SI_TOTAL;for(var i=1;i<=propLen;i++){if(appProperties[i]["SI_WEBI_PROPERTY_ID"]=="WEBI_VIEW_LATEST_INSTANCE"){isLatestInstanceSelected=appProperties[i]["SI_WEBI_PROPERTY_VALUE"]=="true"?true:false;break;}}}return isLatestInstanceSelected;}};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.openChildDocument=function(channel,event,data){var objData={};var BOEInfo={SAPLogonToken:BILaunchpadApp.getlogonToken(),PVL:BILaunchpadApp.getPreferredViewingLocale(),WebServiceURL:BILaunchpadApp.getWebServiceBaseURL(),Language:BILaunchpadApp.getProductLocale()};objData.actiontechname=data.techname;objData.type=data.type;objData.name=data.title;objData.id=data.id;objData.boe=BOEInfo;objData.openDocParameters=data.openDocParameters;this.renderPage(objData);};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.renderPage=function(objData){var that=this;if(objData.isOneClick==undefined){objData.isOneClick=false;}var instanceObjData=objData;var bSmartViewLatestInstance=false;var isOneClickView=objData.isOneClick;if(isOneClickView&&instanceObjData.isinstance!="true"&&instanceObjData.container!="inbox"&&instanceObjData.filter!=BILaunchpadApp.oConstants.HOME_RECENT){bSmartViewLatestInstance=this.isSmartViewLatestInstance(objData);}if(instanceObjData.displaytype!="undefined"&&instanceObjData.displaytype!="BI Workspace"){if(instanceObjData.actiontechname==BILaunchpadApp.oConstants.VIEW_LATEST_INSTANCE||(instanceObjData.actiontechname==BILaunchpadApp.oConstants.VIEW&&bSmartViewLatestInstance)){instanceObjData=this.updateLatestInstanceObjectData(instanceObjData);}}this.setOfflineHelpParameter(instanceObjData);var reportSetting;if(instanceObjData.type=="AFDashboardPage"||instanceObjData.displaytype=="BI Workspace"){reportSetting=true;}else{if(objData.viewInBrowserTab===true){reportSetting=false;delete objData.viewInBrowserTab;}else{if(BILaunchpadApp.getViewReportInBILP()==true){reportSetting=true;}else{reportSetting=false;}}}if(reportSetting==true&&BILaunchpadApp.oBILaunchpadUtil.isUnifiedViewSupported(instanceObjData.type)){if(!BILaunchpadApp.homeIcon.getVisible()){BILaunchpadApp.homeIcon.setVisible(true);}if(!BILaunchpadApp.backIcon.getVisible()){BILaunchpadApp.backIcon.setVisible(true);}if(BILaunchpadApp.editHomePageIcon.getVisible()){BILaunchpadApp.editHomePageIcon.setVisible(false);}if(BILaunchpadApp.refreshIcon.getVisible()){BILaunchpadApp.refreshIcon.setVisible(false);}var oClientActionSets=this.getCAFActionSets(instanceObjData.type);var handler=this.getCAFImpl(oClientActionSets[0].name,false);var eventBus=sap.ui.getCore().getEventBus();this.overflowUnifiedPageId=Math.floor(Math.random()*90000)+10000;var unifiedViewerPage=new sap.m.Page(objData.type+objData.cuid+this.overflowUnifiedPageId,{enableScrolling:false});unifiedViewerPage.addStyleClass("BILP-Opacity");unifiedViewerPage.setShowHeader(false);instanceObjData.pageId=unifiedViewerPage.getId();instanceObjData.title=instanceObjData.name||instanceObjData.title;var contentAdded=false;sap.ui.getCore().setModel("","biwEditModel");sap.ui.getCore().setModel("","biwEditCuid");sap.ui.getCore().setModel("","biwEdittitle");sap.ui.getCore().setModel("","biwEditFlag");if(instanceObjData.actiontechname=="modify"&&instanceObjData.type=="CrystalReport"){this.getContainerId(instanceObjData.id);var containerId=sap.ui.getCore().getModel("containerId");var oBasicLayout=new sap.ui.layout.VerticalLayout({width:"100%",height:"100%"});oBasicLayout.addStyleClass("viewerheight viewerVltheight sapUiSizeCompact");htmlview=new sap.ui.core.HTML({preferDOM:true,width:"100%",height:"100%"}).addStyleClass("viewerheight");htmlview.setContent("<iframe src='"+BILaunchpadApp.getBaseURL().substring(0,BILaunchpadApp.getBaseURL().length-9)+instanceObjData.contextpath+instanceObjData.url+"&cafWebSesInit=true&bttoken="+callbackGetBTToken()+"&appKind=bing&service=%2FInfoView%2Fcommon%2FappService.do&loc="+BILaunchpadApp.getProductLocale()+"&pvl="+BILaunchpadApp.getPreferredViewingLocale()+"&ctx=standalone&actId="+instanceObjData.actId+"&objIds="+instanceObjData.id+"&containerId="+containerId+"&pref=maxOpageUt%3D200%3BmaxOpageC%3D10%3Btz%3DAmerica%2FLos_Angeles%3BmUnit%3Dinch%3BshowFilters%3Dtrue%3BsmtpFrom%3Dtrue%3BpromptForUnsavedData%3Dtrue%3B' style='height:100% !important; width: 100%!important;' ></iframe>");htmlview.setSanitizeContent(true);oBasicLayout.addContent(htmlview);unifiedViewerPage.addContent(oBasicLayout);contentAdded=true;BILaunchpadApp.getNavContainer().addPage(unifiedViewerPage);if(BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr==""){BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr=objData.type+objData.cuid+this.overflowUnifiedPageId;}else{if(BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level==0){BILaunchpadApp.navPoints.push({level:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level+1,curr:objData.type+objData.cuid+this.overflowUnifiedPageId,currString:objData.name,prev:"tabPage",backAction:"tabPage"});}else{BILaunchpadApp.navPoints.push({level:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level+1,curr:objData.type+objData.cuid+this.overflowUnifiedPageId,currString:objData.name,prev:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr,backAction:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr});}}}else{if(instanceObjData.actiontechname=="modify"&&instanceObjData.type=="AFDashboardPage"){var reqDispatcher=new RequestDispatcher();var title=instanceObjData.title;var cuid=instanceObjData.cuid;var modifyJSON=function(model){var mainPage=null,mainPageLayout=null,mainPageName=null;var TabPage=null,TabPageLayout=null,TabPageName=null;var alteredModel=new sap.ui.model.json.JSONModel();var aDataCopy=JSON.parse(JSON.stringify(model));alteredModel=aDataCopy;Object.keys(alteredModel.BIW).forEach(function(Tab){delete alteredModel.BIW[Tab];});Object.keys(model.BIW).forEach(function(Tab){if(model.BIW[Tab].LAYOUT!=undefined&&model.BIW[Tab].TABPAGE==undefined){mainPage=model.BIW[Tab];mainPageLayout=model.BIW[Tab].LAYOUT;mainPageName=Tab;alteredModel.BIW[mainPageName+" "]={TABPAGE:{LAYOUT:{TEMPLATE_MODE:{},PAGE:{HEADER:{HEIGHT:"1"},COLUMN:{CONTAINER0:{TYPE:"vertical"}}}}}};alteredModel.BIW[mainPageName+" "][mainPageName+" "]={LAYOUT:mainPageLayout};}if(model.BIW[Tab].TABPAGE!=undefined&&model.BIW[Tab].TABPAGE.LAYOUT!=undefined){TabPage=model.BIW[Tab];TabPageLayout=model.BIW[Tab].TABPAGE.LAYOUT;TabPageName=Tab;var tabCopy=JSON.parse(JSON.stringify(TabPage));alteredModel.BIW[TabPageName]=tabCopy;Object.keys(alteredModel.BIW[TabPageName]).forEach(function(Tab1){delete alteredModel.BIW[TabPageName][Tab1];});if(TabPage!=null){model.BIW[TabPageName][TabPageName]={LAYOUT:TabPageLayout};alteredModel.BIW[TabPageName][TabPageName]={LAYOUT:TabPageLayout};delete model.BIW[TabPageName].DEFAULTPAGE;delete model.BIW[TabPageName].LAYOUT;delete alteredModel.BIW[TabPageName].DEFAULTPAGE;delete alteredModel.BIW[TabPageName].LAYOUT;}Object.keys(model.BIW[TabPageName]).forEach(function(subTab){var subTabName=subTab;alteredModel.BIW[TabPageName][subTabName]=model.BIW[TabPageName][subTabName];});}});model.BIW[mainPageName+" "]={TABPAGE:{LAYOUT:{TEMPLATE_MODE:{},PAGE:{HEADER:{HEIGHT:"1"},COLUMN:{CONTAINER0:{TYPE:"vertical"}}}},DEFAULTPAGE:""}};model.BIW[mainPageName+" "][mainPageName+" "]={LAYOUT:mainPageLayout};model.BIW=alteredModel.BIW;model.BIW[mainPageName]={LAYOUT:{TEMPLATE_MODE:{},PAGE:{HEADER:{HEIGHT:"1"},COLUMN:{CONTAINER0:{TYPE:"vertical"}}}},DEFAULTPAGE:""};};var getsidataSuccess=function(response){if(response.SI_VERSION=="4.2"){modifyJSON(response);}sap.ui.getCore().setModel(response,"biwEditModel");sap.ui.getCore().setModel(instanceObjData.cuid,"biwEditCuid");sap.ui.getCore().setModel(instanceObjData.title,"biwEdittitle");sap.ui.getCore().setModel(instanceObjData.parentcuid,"saveSelectedParentCUID");sap.ui.getCore().setModel("true","biwEditFlag");jQuery.sap.require("com.sap.fioribi.modules.biworkspace.landingPage.biwLandingPageContainer");oContent=new com.sap.fioribi.modules.biworkspace.landingPage.biwLandingPageContainer();unifiedViewerPage.addContent(oContent.getUI());contentAdded=true;BILaunchpadApp.getNavContainer().addPage(unifiedViewerPage);if(BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr==""){BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr=unifiedViewerPage.sId;}var oPageInfo={data:instanceObjData,page:unifiedViewerPage};eventBus.publish(BILaunchpadApp.oConstants.PLATFORM_INTERNAL_CHANNEL,BILaunchpadApp.oConstants.VIEW_EVENT,oPageInfo);};var getsidataerror=function(response){};var url;url=BILaunchpadApp.getWebServiceBaseURL()+"/biworkspaceng/internal/v1/biwContent?cuid='"+instanceObjData.cuid+"'";var request={surl:url,reqType:"GET",successHandler:getsidataSuccess,errorHandler:getsidataerror,headers:{"x-SAP-logonToken":BILaunchpadApp.getlogonToken(),Accept:"application/json","Content-Type":"application/json;odata=verbose",}};reqDispatcher.sendRequest(request);}else{if(instanceObjData.type=="Publication"){var oContent=handler.getContent(instanceObjData);if(oContent){unifiedViewerPage.addContent(oContent);contentAdded=true;}}else{if(instanceObjData.type!="AFDashboardPage"&&instanceObjData.type!="Analytic"){if(handler){var oContent=handler.getContent(instanceObjData);if(oContent){unifiedViewerPage.addContent(oContent);contentAdded=true;}if(!(instanceObjData.type=="ExternalHyperlink"&&(instanceObjData.hyperlink!=undefined&&instanceObjData.hyperlink.substring(0,5)=="https"))){BILaunchpadApp.getNavContainer().addPage(unifiedViewerPage);}if(BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr==""){BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr=objData.type+objData.cuid+this.overflowUnifiedPageId;BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].currString=objData.name;}else{if(BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level==0){BILaunchpadApp.navPoints.push({level:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level+1,currString:objData.name,curr:objData.type+objData.cuid+this.overflowUnifiedPageId,prev:"tabPage",backAction:"tabPage"});}else{if(!(instanceObjData.type=="ExternalHyperlink"&&(instanceObjData.hyperlink!=undefined&&instanceObjData.hyperlink.substring(0,5)=="https"))){BILaunchpadApp.navPoints.push({level:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level+1,currString:objData.name,curr:objData.type+objData.cuid+this.overflowUnifiedPageId,prev:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr,backAction:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr});}}}}}else{if(instanceObjData.cuid!==""){var reqDispatcher=new RequestDispatcher();var backgroundImageJson=sap.ui.getCore().getModel("biwPreferencesModel");if(backgroundImageJson==undefined){var getPreferencesSuccess=function(response){sap.ui.getCore().setModel(response,"biwPreferencesModel");that.bgImageflag=true;};var getPreferencesError=function(response){that.bgImageflag=true;};var request={surl:BILaunchpadApp.getWebServiceBaseURL()+"/biworkspaceng/internal/v1/preferences",reqType:"GET",successHandler:getPreferencesSuccess,errorHandler:getPreferencesError,async:true,headers:{"x-SAP-logonToken":BILaunchpadApp.getlogonToken(),Accept:"application/json","Content-Type":"application/json;odata=verbose",}};reqDispatcher.sendRequest(request);}var getsidataSuccess=function(response){sap.ui.getCore().setModel(response,"biwViewModel");sap.ui.getCore().setModel(instanceObjData.cuid,"biwViewCuid");sap.ui.getCore().setModel(instanceObjData.title,"biwtitle");sap.ui.getCore().setModel(that.bgImageflag,"bgImg");jQuery.sap.require("com.sap.biwng.caf.biwng.biwngContainer");var oContent=new com.sap.biwng.caf.biwng.biwngContainer();unifiedViewerPage.addContent(oContent.getUI());contentAdded=true;BILaunchpadApp.getNavContainer().addPage(unifiedViewerPage);if(BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr==""){BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr=unifiedViewerPage.sId;if(instanceObjData.displaytype==BILaunchpadApp.localized("bi_workspace")){BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].customType="bi_workspace";}}else{if(BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level==0){BILaunchpadApp.navPoints.push({level:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level+1,curr:unifiedViewerPage.sId,customType:"bi_workspace",prev:"tabPage",backAction:"tabPage"});}else{BILaunchpadApp.navPoints.push({level:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level+1,curr:unifiedViewerPage.sId,customType:"bi_workspace",prev:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr,backAction:BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].curr});}}var oPageInfo={data:instanceObjData,page:unifiedViewerPage};eventBus.publish(BILaunchpadApp.oConstants.PLATFORM_INTERNAL_CHANNEL,BILaunchpadApp.oConstants.VIEW_EVENT,oPageInfo);};var getsidataerror=function(response){};var url;if(instanceObjData.type=="AFDashboardPage"){url=BILaunchpadApp.getWebServiceBaseURL()+"/biworkspaceng/internal/v1/biwContent?cuid='"+instanceObjData.cuid+"'";}else{url=BILaunchpadApp.getWebServiceBaseURL()+"/biworkspaceng/internal/v1/moduleContent?cuid='"+instanceObjData.cuid+"'";}var request={surl:url,reqType:"GET",successHandler:getsidataSuccess,errorHandler:getsidataerror,headers:{"x-SAP-logonToken":BILaunchpadApp.getlogonToken(),Accept:"application/json","Content-Type":"application/json;odata=verbose",}};reqDispatcher.sendRequest(request);}else{var addon=false;var oContent;BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Hyperlink.css");switch(instanceObjData.id){case"Documents":if(instanceObjData.docViewId!==""){if(instanceObjData.docViewId!=undefined){BILaunchpadApp.setCurrentSection(instanceObjData.docViewId);}else{BILaunchpadApp.setFooterStatus(true);BILaunchpadApp.setCurrentSection("1");}}jQuery.sap.require("com.sap.fioribi.modules.Documents.ShowAllPageContainer");oContent=new com.sap.fioribi.modules.Documents.ShowAllPageContainer();break;case"Schedules":jQuery.sap.require("com.sap.fioribi.modules.schedule.scheduleContainer");oContent=new com.sap.fioribi.modules.schedule.scheduleContainer();break;case"Categories":BILaunchpadApp.setCurrentSection("4");jQuery.sap.require("com.sap.fioribi.modules.categories.categoriesContainer");oContent=new com.sap.fioribi.modules.categories.categoriesContainer();break;case"Inbox":jQuery.sap.require("com.sap.fioribi.modules.inboxtab.InboxTabContentsContainer");oContent=new com.sap.fioribi.modules.inboxtab.InboxTabContentsContainer();break;case"Folders":jQuery.sap.require("com.sap.fioribi.modules.folders.foldersContainer");oContent=new com.sap.fioribi.modules.folders.foldersContainer();break;case"RecycleBin":jQuery.sap.require("com.sap.fioribi.modules.recyclebin.recycleBinContainer");oContent=new com.sap.fioribi.modules.recyclebin.recycleBinContainer();break;case"BI Workspace":sap.ui.getCore().setModel(unifiedViewerPage.getId(),"biwPageID");jQuery.sap.require("com.sap.fioribi.modules.biworkspace.biworkspaceContainer");oContent=new com.sap.fioribi.modules.biworkspace.biworkspaceContainer();break;case"biwCreate":jQuery.sap.require("com.sap.fioribi.modules.biworkspace.landingPage.biwLandingPageContainer");oContent=new com.sap.fioribi.modules.biworkspace.landingPage.biwLandingPageContainer();break;case"Module":var oBasicLayout=new sap.ui.layout.VerticalLayout({width:"100%",height:"100%"});oBasicLayout.addStyleClass("viewerheight viewerVltheight sapUiSizeCompact");htmlview=new sap.ui.core.HTML({preferDOM:true,width:"100%",height:"100%"}).addStyleClass("viewerheight");htmlview.setContent("<iframe src='"+BILaunchpadApp.getBaseURL().substring(0,BILaunchpadApp.getBaseURL().length-9)+instanceObjData.contextPath+instanceObjData.url+"?cafWebSesInit=true&bttoken="+callbackGetBTToken()+"&appKind=InfoView&service=%2FInfoView%2Fcommon%2FappService.do&loc="+BILaunchpadApp.getProductLocale()+"&pvl="+BILaunchpadApp.getPreferredViewingLocale()+"&ctx=standalone&actId=4578&objIds=0&containerId=0&pref=maxOpageUt%3D200%3BmaxOpageC%3D10%3Btz%3DAmerica%2FLos_Angeles%3BmUnit%3Dinch%3BshowFilters%3Dtrue%3BsmtpFrom%3Dtrue%3BpromptForUnsavedData%3Dtrue%3B&tidtime=4578-0-1551767237523' style='height:100% !important; width: 99.5% !important;' ></iframe>");htmlview.setSanitizeContent(true);oBasicLayout.addContent(htmlview);unifiedViewerPage.addContent(oBasicLayout);addon=true;break;case"Analysis edition for OLAP":var oBasicLayout=new sap.ui.layout.VerticalLayout({width:"100%",height:"100%"});oBasicLayout.addStyleClass("viewerheight viewerVltheight sapUiSizeCompact");htmlview=new sap.ui.core.HTML({preferDOM:true,width:"100%",height:"100%"}).addStyleClass("viewerheight");htmlview.setContent("<iframe src='"+BILaunchpadApp.getBaseURL().substring(0,BILaunchpadApp.getBaseURL().length-9)+instanceObjData.contextPath+instanceObjData.url+"&cafWebSesInit=true&bttoken="+callbackGetBTToken()+"&bttoken="+callbackGetBTToken()+"&appKind=InfoView&service=%2FInfoView%2Fcommon%2FappService.do&loc="+BILaunchpadApp.getProductLocale()+"&pvl="+BILaunchpadApp.getPreferredViewingLocale()+"&ctx=standalone&actId="+instanceObjData.si_id+"&containerId=&pref=maxOpageUt%3D200%3BmaxOpageC%3D10%3Btz%3DAmerica%2FLos_Angeles%3BmUnit%3Dinch%3BshowFilters%3Dtrue%3BsmtpFrom%3Dtrue%3BpromptForUnsavedData%3Dtrue%3B&tidtime=4650-1551764252508' style='height:100% !important; width: 100%!important;' ></iframe>");htmlview.setSanitizeContent(true);oBasicLayout.addContent(htmlview);unifiedViewerPage.addContent(oBasicLayout);addon=true;break;case"Information Steward":var oBasicLayout=new sap.ui.layout.VerticalLayout({width:"100%",height:"100%"});oBasicLayout.addStyleClass("viewerheight viewerVltheight sapUiSizeCompact");htmlview=new sap.ui.core.HTML({preferDOM:true,width:"100%",height:"100%"}).addStyleClass("viewerheight");htmlview.setContent("<iframe src='"+BILaunchpadApp.getBaseURL().substring(0,BILaunchpadApp.getBaseURL().length-9)+instanceObjData.contextPath+instanceObjData.url+"?cafWebSesInit=true&bttoken="+callbackGetBTToken()+"&bttoken="+callbackGetBTToken()+"&appKind=InfoView&service=%2FInfoView%2Fcommon%2FappService.do&loc="+BILaunchpadApp.getProductLocale()+"&pvl="+BILaunchpadApp.getPreferredViewingLocale()+"&ctx=standalone&actId="+instanceObjData.si_id+"&containerId=&pref=maxOpageUt%3D200%3BmaxOpageC%3D10%3Btz%3DAmerica%2FLos_Angeles%3BmUnit%3Dinch%3BshowFilters%3Dtrue%3BsmtpFrom%3Dtrue%3BpromptForUnsavedData%3Dtrue%3B' style='height:100% !important; width: 100%!important;' ></iframe>");htmlview.setSanitizeContent(true);oBasicLayout.addContent(htmlview);unifiedViewerPage.addContent(oBasicLayout);addon=true;break;case"Crystal Reports for Enterprise":var oBasicLayout=new sap.ui.layout.VerticalLayout({width:"100%",height:"100%"});oBasicLayout.addStyleClass("viewerheight viewerVltheight sapUiSizeCompact");htmlview=new sap.ui.core.HTML({preferDOM:true,width:"100%",height:"100%"}).addStyleClass("viewerheight");htmlview.setContent("<iframe src='"+BILaunchpadApp.getBaseURL().substring(0,BILaunchpadApp.getBaseURL().length-9)+instanceObjData.contextPath+instanceObjData.url+"?cafWebSesInit=true&bttoken="+callbackGetBTToken()+"&bttoken="+callbackGetBTToken()+"&appKind=InfoView&service=%2FInfoView%2Fcommon%2FappService.do&loc="+BILaunchpadApp.getProductLocale()+"&pvl="+BILaunchpadApp.getPreferredViewingLocale()+"&ctx=standalone&actId="+instanceObjData.si_id+"&containerId=&pref=maxOpageUt%3D200%3BmaxOpageC%3D10%3Btz%3DAmerica%2FLos_Angeles%3BmUnit%3Dinch%3BshowFilters%3Dtrue%3BsmtpFrom%3Dtrue%3BpromptForUnsavedData%3Dtrue%3B' style='height:100% !important; width: 100%!important;' ></iframe>");htmlview.setSanitizeContent(true);oBasicLayout.addContent(htmlview);unifiedViewerPage.addContent(oBasicLayout);addon=true;break;case"Web Intelligence":var oBasicLayout=new sap.ui.layout.VerticalLayout({width:"100%",height:"100%"});oBasicLayout.addStyleClass("viewerheight viewerVltheight sapUiSizeCompact");htmlview=new sap.ui.core.HTML({preferDOM:true,width:"100%",height:"100%"}).addStyleClass("viewerheight");htmlview.setContent("<iframe src='"+BILaunchpadApp.getBaseURL().substring(0,BILaunchpadApp.getBaseURL().length-9)+instanceObjData.contextPath+instanceObjData.url+"&cafWebSesInit=true&bttoken="+callbackGetBTToken()+"&bttoken="+callbackGetBTToken()+"&appKind=InfoView&service=%2FInfoView%2Fcommon%2FappService.do&loc="+BILaunchpadApp.getProductLocale()+"&pvl="+BILaunchpadApp.getPreferredViewingLocale()+"&ctx=standalone&actId="+instanceObjData.si_id+"&containerId=&pref=maxOpageUt%3D200%3BmaxOpageC%3D10%3Btz%3DAmerica%2FLos_Angeles%3BmUnit%3Dinch%3BshowFilters%3Dtrue%3BsmtpFrom%3Dtrue%3BpromptForUnsavedData%3Dtrue%3B&tidtime=4905-1551768263117' style='height:100% !important; width: 100%!important;' ></iframe>");htmlview.setSanitizeContent(true);oBasicLayout.addContent(htmlview);unifiedViewerPage.addContent(oBasicLayout);addon=true;break;case"Lumira Discovery":var oBasicLayout=new sap.ui.layout.VerticalLayout({width:"100%",height:"100%"});oBasicLayout.addStyleClass("viewerheight viewerVltheight sapUiSizeCompact");htmlview=new sap.ui.core.HTML({preferDOM:true,width:"100%",height:"100%"}).addStyleClass("viewerheight");htmlview.setContent("<iframe src='"+BILaunchpadApp.getBaseURL().substring(0,BILaunchpadApp.getBaseURL().length-9)+instanceObjData.contextPath+instanceObjData.url+"&cafWebSesInit=true&bttoken="+callbackGetBTToken()+"&bttoken="+callbackGetBTToken()+"&appKind=InfoView&service=%2FInfoView%2Fcommon%2FappService.do&loc="+BILaunchpadApp.getProductLocale()+"&pvl="+BILaunchpadApp.getPreferredViewingLocale()+"&ctx=standalone&actId="+instanceObjData.si_id+"&containerId=&pref=maxOpageUt%3D200%3BmaxOpageC%3D10%3Btz%3DAmerica%2FLos_Angeles%3BmUnit%3Dinch%3BshowFilters%3Dtrue%3BsmtpFrom%3Dtrue%3BpromptForUnsavedData%3Dtrue%3B&tidtime=7862-1551856265058' style='height:100% !important; width: 100%!important;' ></iframe>");htmlview.setSanitizeContent(true);oBasicLayout.addContent(htmlview);unifiedViewerPage.addContent(oBasicLayout);addon=true;break;}if(addon!=true){unifiedViewerPage.addContent(oContent.getUI());}contentAdded=true;BILaunchpadApp.getNavContainer().addPage(unifiedViewerPage);var level=1;if(BILaunchpadApp.navPoints.length>0){level=BILaunchpadApp.navPoints[BILaunchpadApp.navPoints.length-1].level+1;}BILaunchpadApp.navPoints.push({level:level,curr:objData.type+objData.cuid+this.overflowUnifiedPageId,currString:objData.name,prev:"tabPage",backAction:"tabPage"});}}}}}var oPageInfo={data:instanceObjData,page:unifiedViewerPage};if(contentAdded===true){eventBus.publish(BILaunchpadApp.oConstants.PLATFORM_INTERNAL_CHANNEL,BILaunchpadApp.oConstants.VIEW_EVENT,oPageInfo);}if(!(instanceObjData.type=="ExternalHyperlink"&&(instanceObjData.hyperlink!=undefined&&instanceObjData.hyperlink.substring(0,5)=="https"))){BILaunchpadApp.getHomePage().oController.setHeaderLabel(objData.name);}}else{var oClientActionSets=this.getCAFActionSets("OpenDoc");var handler=this.getCAFImpl(oClientActionSets[0].name,true);if(handler){instanceObjData.reportSetting=reportSetting;var oContent=handler.showOpenDocument(instanceObjData);}}objData.isOneClick=false;if(instanceObjData.displaytype!="undefined"&&BILaunchpadApp.isHyperLink==undefined&&(instanceObjData.autosaveoriginaldocid=="0"||instanceObjData.autosaveoriginaldocid==""||instanceObjData.autosaveoriginaldocid==undefined)){this.updateDocumentLastViewedStatus(instanceObjData.id);}if(BILaunchpadApp.isHyperLink!=undefined&&BILaunchpadApp.isHyperLink==true){BILaunchpadApp.isHyperLink=undefined;}};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.setOfflineHelpParameter=function(instanceObjData){instanceObjData.offlinehelpflag=offlinehelpflag;instanceObjData.offlinehelpurl=offlinehelpurl;};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.getContainerId=function(si_id){var reqDispatcher=new RequestDispatcher();var modelData="SELECT SI_PARENT_FOLDER FROM CI_INFOOBJECTS WHERE SI_ID ='"+si_id+"'";var dataPost={query:modelData};dataPost=JSON.stringify(dataPost);var fnSuccess=function(oResponse){if(oResponse.entries[0]!=undefined){sap.ui.getCore().setModel(oResponse.entries[0].SI_PARENT_FOLDER,"containerId");}};var fnError=function(xhr,ajaxOptions,thrownError){};var urlCONS=BILaunchpadApp.getWebServiceBaseURL()+"/v1/cmsquery";var request={surl:urlCONS,reqType:"POST",bAsync:false,data:dataPost,successHandler:function(data,textStatus,xhr){fnSuccess(data,textStatus,xhr);},errorHandler:function(){fnError();},headers:{Accept:"application/json","Content-Type":"application/json;odata=verbose","x-sap-logontoken":BILaunchpadApp.getlogonToken()}};reqDispatcher.sendRequest(request);};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.getCAFActionSets=function(sInfoObjectType){var sClassName=sInfoObjectType+"_Viewer";if(sClassName){sClassName=sClassName.replace(/\./g,"_");}sClassName=sClassName.charAt(0).toUpperCase()+sClassName.slice(1);var oClientActionSets=[{name:sClassName}];return oClientActionSets;};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.setClientActionHandler=function(oClientActinHandler){this.oClientActionHandler=oClientActinHandler;};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.setInfoObjectType=function(sInfoObjectType){this.sInfoObjectType=sInfoObjectType;};com.sap.fioribi.caf.unifiedviewer.platform.UnifiedViewerHandler.prototype.updateDocumentLastViewedStatus=function(docId){if((docId!=="Documents")&&(docId!=="Schedules")&&(docId!=="Categories")&&(docId!=="Inbox")&&(docId!=="Folders")&&(docId!=="RecycleBin")&&(docId!=="undefined")&&(docId!=="Analysis edition for OLAP")&&(docId!=="Information Steward")&&(docId!=="Crystal Reports for Enterprise")&&(docId!=="BI Workspace")&&(docId!=="Web Intelligence")){var formData={};formData.id=""+docId;var updateSuccess=function(response){};var updateFailed=function(xhr,ajaxOptions,thrownError){console.log("failed to update document viewed timestamp");};var reqDispatcher=new RequestDispatcher();var request={surl:BILaunchpadApp.getWebServiceBaseURL()+"/internal/v1/settings/myinfo/recentlyvieweddocs",reqType:"POST",data:JSON.stringify(formData),successHandler:updateSuccess,errorHandler:updateFailed,headers:{"x-SAP-logonToken":BILaunchpadApp.getlogonToken(),Accept:"application/json","Content-Type":"application/json;odata=verbose",}};reqDispatcher.sendRequest(request);}};