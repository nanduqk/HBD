/*
ï¿½2010 - 2016 SAP SE or an SAP affiliate company.  All rights reserved.
 
SAP and other SAP products and services mentioned herein as well as their respective logos are trademarks or registered trademarks of SAP SE in Germany and other countries.  Please see http://www.sap.com/corporate-en/legal/copyright/index.epx#trademark for additional trademark information and notices.
*/

jQuery.sap.declare({modName:"com.sap.fioribi.modules.logonpage.LogonpageView",type:"view"});jQuery.sap.require({modName:"com.sap.fioribi.modules.common.BILPView",type:"view"});jQuery.sap.require("com.sap.fioribi.app.BILaunchpadApp");com.sap.fioribi.modules.logonpage.LogonpageView=function(){com.sap.fioribi.modules.common.BILPView.apply(this,arguments);};com.sap.fioribi.modules.logonpage.LogonpageView.prototype=jQuery.sap.newObject(com.sap.fioribi.modules.common.BILPView.prototype);com.sap.fioribi.modules.logonpage.LogonpageView.prototype.getControllerName=function(){return"com.sap.fioribi.modules.logonpage.LogonpageController";};com.sap.fioribi.modules.logonpage.LogonpageView.prototype.createContent=function(oController){BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/UserSettings.css");var resourceBundle;var invokeCallback=findCallback("callbackGetResourceBundle");if(invokeCallback!=null){resourceBundle=invokeCallback();}BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Logonpage.css");var srcPath;var invokeCallback=findCallback("callbackIsThemeEnabled");var isThemeEnabled=null;if(invokeCallback!=null){isThemeEnabled=invokeCallback();}if(isThemeEnabled!=null&&isThemeEnabled.toLowerCase()=="custom"){BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/custom-css/Theme.css");srcPath="com/sap/fioribi/css/custom-css/Company_logo.png";}else{BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Default.css");srcPath="com/sap/fioribi/images/SAP_logo.png";}var loginPage=new sap.m.Page({enableScrolling:false,showHeader:false,}).addStyleClass("BILP-launchpadbackground");var oMatrixLayout=new sap.m.VBox({}).addStyleClass(" BILP-Vbox1");var oLogoIcon=new sap.m.Image({src:srcPath,mode:sap.m.ImageMode.Image,}).addStyleClass("BILP-Logo");var customGreetingMsg;var invokeCallback=findCallback("callbackGreeting");if(invokeCallback!=null){customGreetingMsg=invokeCallback();}if(customGreetingMsg=="null"){customGreetingMsg=resourceBundle.getText("login_title");}var oHeadLabel=new sap.m.Label({text:customGreetingMsg}).addStyleClass("BILP-header");var oSubLabelText=resourceBundle.getText("password_change_warning");var oSubLabel=new sap.m.Label({text:oSubLabelText,visible:false,}).addStyleClass("BILP-subheader");var oErrorMessageStrip=new sap.m.MessageStrip({text:"",showIcon:true,showCloseButton:true,visible:false,type:sap.ui.core.MessageType.Error}).addStyleClass("BILP-Error-Label");var ochgpwdinstructionfirstLabel=new sap.m.Label({text:""}).addStyleClass("BILP-Label");var ochgpwdinstructionsecondLabel=new sap.m.Label({text:""}).addStyleClass("BILP-Label");var oSystemLabel=new sap.m.Label({text:"System",visible:false}).addStyleClass("BILP-Label");var oSystemInputText=resourceBundle.getText("system_placeholder");var oSystemInput=new sap.m.Input({placeholder:oSystemInputText,visible:false,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass("BILP-Inputbox");oSystemLabel.setLabelFor(oSystemInput);oMatrixLayout.addItem(oSystemInput);var osapSystemLabel=new sap.m.Label({text:"SAP System",visible:false}).addStyleClass("BILP-Label");var osapSystemInputText=resourceBundle.getText("sap_system_placeholder");var osapSystemInput=new sap.m.Input({placeholder:osapSystemInputText,visible:false,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass("BILP-Inputbox");osapSystemLabel.setLabelFor(osapSystemInput);oMatrixLayout.addItem(osapSystemInput);var osapClientLabelText=resourceBundle.getText("sap_client_placeholder");var osapClientLabel=new sap.m.Label({text:osapClientLabelText,visible:false}).addStyleClass("BILP-Label");var osapClientInputText=resourceBundle.getText("sap_client_placeholder");var osapClientInput=new sap.m.Input({placeholder:osapClientInputText,visible:false,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass("BILP-Inputbox");osapClientLabel.setLabelFor(osapClientInput);oMatrixLayout.addItem(osapClientInput);var oNameLabel=new sap.m.Label({text:"Username"}).addStyleClass("BILP-Label");var usernameText=resourceBundle.getText("user_Name_placeholder");var oNameInput=new sap.m.Input({placeholder:usernameText,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass("BILP-Inputbox");oNameLabel.setLabelFor(oNameInput);oMatrixLayout.addItem(oNameInput);var pwdText=resourceBundle.getText("password_placeholder");oPWLabel=new sap.m.Label({text:"Password"}).addStyleClass("BILP-Label");oPWInput=new sap.m.Input({type:"Password",placeholder:pwdText,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass("BILP-Inputbox");oPWLabel.setLabelFor(oPWInput);oMatrixLayout.addItem(oPWInput);var ochgpwdNameLabel=new sap.m.Label({text:"User Name",visible:false}).addStyleClass("BILP-Label");var ochgpwdInputText=resourceBundle.getText("user_Name_placeholder");var ochgpwdInput=new sap.m.Input({placeholder:ochgpwdInputText,width:"300px",visible:false}).addStyleClass("BILP-Inputbox");ochgpwdNameLabel.setLabelFor(ochgpwdInput);oMatrixLayout.addItem(ochgpwdInput);var oldPWLabel=new sap.m.Label({text:"Old Password",visible:false}).addStyleClass("BILP-Label1");var oldPWInputText=resourceBundle.getText("old_password_placeholder");var oldPWInput=new sap.m.Input({type:"Password",placeholder:oldPWInputText,visible:false,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass("BILP-marginleftChangePassword BILP-Inputbox");oldPWLabel.setLabelFor(oldPWInput);oMatrixLayout.addItem(oldPWInput);var oInfoIcon=new sap.m.Image({src:"com/sap/fioribi/images/InfoIcon.png",width:"32px",height:"32px",visible:false,mode:sap.m.ImageMode.Background}).addStyleClass("BILP-InfoLogo");var newPWLabel=new sap.m.Label({text:"New Password",visible:false}).addStyleClass("BILP-Label1");var newPWInputText=resourceBundle.getText("new_password_placeholder");var newPWInput=new sap.m.Input({type:"Password",placeholder:newPWInputText,visible:false,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass("BILP-marginleftChangePassword BILP-Inputbox");newPWLabel.setLabelFor(newPWInput);oMatrixLayout.addItem(newPWInput,oInfoIcon);var confirmPWLabel=new sap.m.Label({text:"Confirm New Password",visible:false}).addStyleClass("BILP-Label1");var confirmPWInputText=resourceBundle.getText("confirm_new_password_placeholder");var confirmPWInput=new sap.m.Input({type:"Password",placeholder:confirmPWInputText,visible:false,submit:function(oEvent){jQuery($(".BILP-button")).control()[0].firePress();}}).addStyleClass(" BILP-marginleftChangePassword BILP-Inputbox");confirmPWLabel.setLabelFor(confirmPWInput);oMatrixLayout.addItem(confirmPWInput);var oauthenticationLabelText=resourceBundle.getText("authentication_type");var oauthenticationLabel=new sap.m.Label({text:oauthenticationLabelText+":"}).addStyleClass("BILP-Label");var oAuthenticationComboBox=new sap.m.Select({change:function(){if(this.getSelectedItem()!=null&&this.getSelectedItem().getKey()==="secSAPR3"&&sapVisible){osapSystemLabel.setVisible(true);osapSystemInput.setVisible(true);osapClientLabel.setVisible(true);osapClientInput.setVisible(true);}else{osapSystemLabel.setVisible(false);osapSystemInput.setVisible(false);osapClientLabel.setVisible(false);osapClientInput.setVisible(false);}}}).addStyleClass("BILP-Inputbox");oauthenticationLabel.setLabelFor(oAuthenticationComboBox);oMatrixLayout.addItem(oauthenticationLabel);oMatrixLayout.addItem(oAuthenticationComboBox);var oLoginLabel=new sap.m.Label({text:""}).addStyleClass("BILP-Label");var oLoginButtonText=resourceBundle.getText("sign_in_text");var oLoginButton=new sap.m.Button({text:oLoginButtonText,type:"Emphasized"}).addStyleClass("BILP-button");oLoginButton.addStyleClass("BILP-lsLoginButton");oMatrixLayout.addItem(oLoginLabel,oLoginButton);var oLineIcon=new sap.m.Image({height:"1px",width:"600px",mode:sap.m.ImageMode.Background,}).addStyleClass("BILP-Line");var odownLabel3Text=resourceBundle.getText("contact_admin_text");var odownLabel3=new sap.m.Link({text:odownLabel3Text}).addStyleClass("BILP-downLabel BILP-downLabe1");odownLabel3.attachPress(function(){$(document).ready(function(){openInNewTab(usermailId);function openInNewTab(user_id){var newTab=window;newTab.opener=null;newTab.location="mailto:"+user_id;}});});var chgPwd=false;var chgpwdvem;var sapVisible;var invokeCallback=findCallback("callbackGetConfigData");var jsonConfigData;if(invokeCallback!=null){jsonConfigData=invokeCallback();}var jsonData=JSON.parse(jsonConfigData);var defaultAuthentication=null;for(var i=0;i<jsonData.length;i++){var jsonobj=jsonData[i];for(var key in jsonobj){if(key==="isCmsVisible"){if(jsonobj[key]){oSystemLabel.setVisible(true);oSystemInput.setVisible(true);}else{oSystemLabel.setVisible(false);oSystemInput.setVisible(false);}}if(key==="isAuthenticationVisible"){if(jsonobj[key]){oauthenticationLabel.setVisible(true);oAuthenticationComboBox.setVisible(true);}else{oauthenticationLabel.setVisible(false);oAuthenticationComboBox.setVisible(false);}}if(key==="sapVisible"){sapVisible=jsonobj[key];}if(key==="CMS"){oSystemInput.setValue(jsonobj[key]);}if(key==="USERNAME"){oNameInput.setValue(jsonobj[key]);}if(key==="AUTH_TYPE"){defaultAuthentication=jsonobj[key];if(defaultAuthentication==="secSAPR3"&&sapVisible){osapSystemLabel.setVisible(true);osapSystemInput.setVisible(true);osapClientLabel.setVisible(true);osapClientInput.setVisible(true);}else{osapSystemLabel.setVisible(false);osapSystemInput.setVisible(false);osapClientLabel.setVisible(false);osapClientInput.setVisible(false);}}if(key==="SAP_SYSTEM"){osapSystemInput.setValue(jsonobj[key]);}if(key==="SAP_CLIENT"){osapClientInput.setValue(jsonobj[key]);}if(key==="sa"){var supportedAuthentications=jsonobj[key];for(var j=0;j<supportedAuthentications.length;j++){var object=supportedAuthentications[j];for(var property in object){var keyAu=property;var value=object[property];var oListItem=new sap.ui.core.ListItem("cmb"+j,{key:keyAu,text:value,});oAuthenticationComboBox.addItem(oListItem);if(defaultAuthentication!=null&&defaultAuthentication===keyAu){oAuthenticationComboBox.setSelectedItem(oListItem);}}}}if(key==="e"){if(jsonobj[key]!=""){oErrorMessageStrip.setVisible(true);oErrorMessageStrip.setText(jsonobj[key]);}}if(key==="chgPwd"){if(jsonobj[key]){oHeadLabel.setText("Change Password");oSubLabel.setVisible(true);oSystemLabel.setVisible(false);oSystemInput.setVisible(false);osapSystemLabel.setVisible(false);osapSystemInput.setVisible(false);osapClientLabel.setVisible(false);osapClientInput.setVisible(false);oNameLabel.setVisible(false);oNameInput.setVisible(false);ochgpwdInput.setEnabled(false);oldPWLabel.setVisible(true);newPWLabel.setVisible(true);confirmPWLabel.setVisible(true);oPWLabel.setVisible(false);oldPWInput.setVisible(true);newPWInput.setVisible(true);if(defaultAuthentication==="secSAPR3"&&sapVisible){osapSystemLabel.setVisible(true);osapSystemInput.setVisible(true);osapClientLabel.setVisible(true);osapClientInput.setVisible(true);oInfoIcon.setVisible(false);osapSystemInput.addStyleClass("BILP-marginleftChangePassword");osapClientInput.addStyleClass("BILP-marginleftChangePassword");oldPWInput.addStyleClass("BILP-addMarginRight");newPWInput.addStyleClass("BILP-addMarginRight");confirmPWInput.addStyleClass("BILP-addMarginRight");}else{osapSystemLabel.setVisible(false);osapSystemInput.setVisible(false);osapClientLabel.setVisible(false);osapClientInput.setVisible(false);oInfoIcon.setVisible(true);oInfoIcon.setTooltip(resourceBundle.getText("tooltip_text"));}confirmPWInput.setVisible(true);oPWInput.setVisible(false);oauthenticationLabel.setVisible(false);oAuthenticationComboBox.setVisible(false);oLoginButton.addStyleClass("BILP-cpLoginButton");oLoginButton.removeStyleClass("BILP-lsLoginButton");chgPwd=true;}else{ochgpwdNameLabel.setVisible(false);oNameLabel.setVisible(false);oHeadLabel.setText(resourceBundle.getText("login_title"));oldPWLabel.setVisible(false);newPWLabel.setVisible(false);confirmPWLabel.setVisible(false);oPWLabel.setVisible(true);ochgpwdInput.setVisible(false);oNameInput.setVisible(true);oldPWInput.setVisible(false);newPWInput.setVisible(false);confirmPWInput.setVisible(false);oPWInput.setVisible(true);oauthenticationLabel.setVisible(true);oAuthenticationComboBox.setVisible(true);oLoginButton.removeStyleClass("BILP-cpLoginButton");oLoginButton.addStyleClass("BILP-lsLoginButton");chgPwd=false;}}if(key==="USERNAME_CHGPWD"){ochgpwdInput.setValue(jsonobj[key]);}if(key==="instructionfirst"){if(jsonobj[key]!=""){ochgpwdinstructionfirstLabel.setText(jsonobj[key]);}}if(key==="instructionsecond"){if(jsonobj[key]!=""){ochgpwdinstructionsecondLabel.setText(jsonobj[key]);}}if(key==="chgpwdvem"){chgpwdvem=jsonobj[key];}}}oLoginButton.attachPress(function(){var invokeCallback=findCallback("callbackSubmitUserData");if(invokeCallback!=null){if(chgPwd){var newPassword=newPWInput.getValue();var oldPassword=oldPWInput.getValue();var confirmpassword=confirmPWInput.getValue();if(newPassword===oldPassword){oErrorMessageStrip.setVisible(true);oErrorMessageStrip.setText(chgpwdvem);oldPWInput.setValue("");newPWInput.setValue("");confirmPWInput.setValue("");return false;}else{if(newPassword!==confirmpassword){oErrorMessageStrip.setVisible(true);oErrorMessageStrip.setText(chgpwdvem);oldPWInput.setValue("");newPWInput.setValue("");confirmPWInput.setValue("");return false;}}}var selectedAuthentication="";var sapSystem="";var sapClient="";if(oAuthenticationComboBox.getSelectedItem()!=null){selectedAuthentication=oAuthenticationComboBox.getSelectedItem().getKey();if(selectedAuthentication==="secSAPR3"){sapSystem=osapSystemInput.getValue();sapClient=osapClientInput.getValue();}}var LogonFields={CMS:oSystemInput.getValue(),SAP_SYSTEM:sapSystem,SAP_CLIENT:sapClient,USERNAME:oNameInput.getValue(),PASSWORD:oPWInput.getValue(),USERNAME_CHGPWD:oNameInput.getValue(),AUTH_TYPE:selectedAuthentication,OLD_PASSWORD:oldPWInput.getValue(),NEW_PASSWORD:newPWInput.getValue(),CONFIRM_PASSWORD:confirmPWInput.getValue()};invokeCallback(LogonFields);sap.ui.core.BusyIndicator.show(0);}});var oVlayout=new sap.m.VBox({items:[oHeadLabel,oSubLabel,oErrorMessageStrip,oMatrixLayout,oLoginButton,oLineIcon,odownLabel3]}).addStyleClass("sapUiSizeCompact BILP-viewBox");oVlayout.setAlignItems("Center");oVlayout.setJustifyContent("Center");oVlayout.addStyleClass("margin-top");loginPage.addContent(oLogoIcon);loginPage.addContent(oVlayout);return loginPage;};