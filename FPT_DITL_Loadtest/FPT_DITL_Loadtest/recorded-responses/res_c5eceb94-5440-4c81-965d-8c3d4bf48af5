/*
ï¿½2010 - 2016 SAP SE or an SAP affiliate company.  All rights reserved.
 
SAP and other SAP products and services mentioned herein as well as their respective logos are trademarks or registered trademarks of SAP SE in Germany and other countries.  Please see http://www.sap.com/corporate-en/legal/copyright/index.epx#trademark for additional trademark information and notices.
*/

jQuery.sap.declare({modName:"com.sap.fioribi.modules.notifications.NotificationView",type:"view"});jQuery.sap.require({modName:"com.sap.fioribi.modules.common.BILPView",type:"view"});com.sap.fioribi.modules.notifications.NotificationView=function(){com.sap.fioribi.modules.common.BILPView.apply(this,arguments);};com.sap.fioribi.modules.notifications.NotificationView.prototype=jQuery.sap.newObject(com.sap.fioribi.modules.common.BILPView.prototype);com.sap.fioribi.modules.notifications.NotificationView.prototype.getControllerName=function(){return"com.sap.fioribi.modules.notifications.NotificationController";};var notificationList=new sap.m.List({});var notificationController=this;com.sap.fioribi.modules.notifications.NotificationView.prototype.createContent=function(oController){if(BILaunchpadApp.getRtlFlag()==false){BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Homepage.css");}else{BILaunchpadApp.includeStyleSheet("com/sap/fioribi/css/Homepage_rtl.css");}var oPage1=new sap.m.Page({id:"notificationMasterPage",showHeader:false,content:[notificationList]});this.oPage2=new sap.m.Page({id:"notificationDetailPage",showNavButton:true,navButtonPress:function(){var notificationNavCon=sap.ui.getCore().byId("notificationNavCon");notificationNavCon.back();}}).addStyleClass("BILP-notificationDetailTitlePage");this.oNavContainer=new sap.m.NavContainer({id:"notificationNavCon",width:"600px",height:"500px",pages:[oPage1,this.oPage2]}).addStyleClass("BILP-notificationBG");this.oPopover=new sap.m.Popover({placement:sap.m.PlacementType.Bottom,showHeader:false,contentWidth:"600px",contentHeight:"500px",content:this.oNavContainer}).addStyleClass("BILP-notificationBG");return this.oPopover;};com.sap.fioribi.modules.notifications.NotificationView.prototype.setNotificationBanner=function(response){var length=response.entries.length;var count=0;notificationList.removeAllItems();notificationIcon.setText(length);for(var i=0;i<length;i++){var notification=response.entries[i];var unRead=true;var notifcationId=response.entries[i].id;var type=response.entries[i].type;var title=notification.name;count++;var messageDesc=decodeURIComponent(notification.message);messageDesc=messageDesc.replace("[","").replace("]","");var notification1=new sap.m.NotificationListItem({priority:"Medium",title:title,description:messageDesc,unread:unRead,close:function(oEvent){var oItem=oEvent.getSource(),notificationList=oItem.getParent();notificationList.removeItem(oItem);notificationController.markAsRead(notifcationId);notificationIcon.setText(--count);},press:function(oEvent){var title=oEvent.getSource().getTitle();var description=oEvent.getSource().getDescription();var notificationNavCon=sap.ui.getCore().byId("notificationNavCon");if(description.length>1000){notificationController.markAsRead(notifcationId);var detailPage=sap.ui.getCore().byId("notificationDetailPage");var desc=new sap.m.Text({text:description}).addStyleClass("BILP-notificationDetailPage");detailPage.removeAllContent();detailPage.setTitle(title);detailPage.addContent(desc);notificationNavCon.to(detailPage);}}}).addStyleClass("sapContrast sapContrastPlus");notificationList.addItem(notification1);}if(count>0){if(notificationIcon!=undefined){notificationIcon.setText(count);}}};